2022-01-31 19:14:31   Arguments: Namespace(aug_prob=0.5, cache_refresh_rate=1000, colab_folder='aml_training', data_aug=None, dataset_name='pitts30k', datasets_folder='/content/', device='cuda', epochs_num=50, exp_name='default', img_height=600, img_width=800, infer_batch_size=16, lr=1e-05, margin=0.1, model_folder=None, neg_samples_num=1000, negs_num_per_query=10, num_clusters=64, num_workers=8, optimizer='adam', output_folder='drive/MyDrive/aml_training', patience=3, queries_per_epoch=5000, recall_values=[1, 5, 10, 20], seed=0, test_datasets='pitts30k', train_batch_size=4, train_positives_dist_threshold=10, type='NETVLAD', val_positive_dist_threshold=25)
2022-01-31 19:14:31   The outputs are being saved in drive/MyDrive/aml_training
2022-01-31 19:14:31   Using 1 GPUs and 2 CPUs
2022-01-31 19:14:31   Loading dataset Pitts30k from folder /content/
2022-01-31 19:14:31   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-01-31 19:14:31   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-01-31 19:14:32   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-01-31 19:14:32   Train only conv4 of the ResNet-18 (remove conv5), freeze the previous ones
2022-01-31 19:14:32   Using NetVlad network
2022-01-31 19:14:34   using Adam optimizer
2022-01-31 19:14:34   Output dimension of the model is 16384
2022-01-31 19:14:34   Patience: 3
2022-01-31 19:14:34   not improved num: 0
2022-01-31 19:14:34   Start training epoch: 00
2022-01-31 19:14:34   Cache: 0 / 5
2022-01-31 19:18:45   
Traceback (most recent call last):
  File "project_vg/train.py", line 139, in <module>
    triplets_ds.compute_triplets(args, model)
  File "/content/project_vg/datasets_ws.py", line 254, in compute_triplets
    cache = self.compute_cache(args, model, subset_ds, (len(self), args.features_dim))
  File "/content/project_vg/datasets_ws.py", line 215, in compute_cache
    cache[indexes.numpy()] = features.cpu().numpy()
KeyboardInterrupt

2022-01-31 19:21:32   Arguments: Namespace(aug_prob=0.5, cache_refresh_rate=1000, colab_folder='aml_training', data_aug=None, dataset_name='pitts30k', datasets_folder='/content/', device='cuda', epochs_num=50, exp_name='default', img_height=600, img_width=800, infer_batch_size=16, lr=1e-05, margin=0.1, model_folder=None, neg_samples_num=1000, negs_num_per_query=10, num_clusters=64, num_workers=8, optimizer='adam', output_folder='drive/MyDrive/aml_training', patience=3, queries_per_epoch=5000, recall_values=[1, 5, 10, 20], seed=0, test_datasets='pitts30k', train_batch_size=4, train_positives_dist_threshold=10, type='NETVLAD', val_positive_dist_threshold=25)
2022-01-31 19:21:32   The outputs are being saved in drive/MyDrive/aml_training
2022-01-31 19:21:32   Using 1 GPUs and 2 CPUs
2022-01-31 19:21:32   Loading dataset Pitts30k from folder /content/
2022-01-31 19:21:32   Images resized to 800x600
2022-01-31 19:21:33   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-01-31 19:21:33   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-01-31 19:21:33   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-01-31 19:21:33   Train only conv4 of the ResNet-18 (remove conv5), freeze the previous ones
2022-01-31 19:21:33   Using NetVlad network
2022-01-31 19:21:35   using Adam optimizer
2022-01-31 19:21:35   Output dimension of the model is 16384
2022-01-31 19:21:35   Patience: 3
2022-01-31 19:21:35   not improved num: 0
2022-01-31 19:21:35   Start training epoch: 00
2022-01-31 19:21:35   Cache: 0 / 5
2022-01-31 19:41:36   Epoch[00](0/5): current batch triplet loss = 0.0376, average epoch triplet loss = 0.0425
2022-01-31 19:41:36   Cache: 1 / 5
2022-02-01 11:39:03   Arguments: Namespace(aug_prob=0.5, cache_refresh_rate=1000, colab_folder='aml_training', data_aug=None, dataset_name='pitts30k', datasets_folder='/content/', device='cuda', epochs_num=50, exp_name='default', img_height=600, img_width=800, infer_batch_size=16, lr=1e-05, margin=0.1, model_folder=None, neg_samples_num=1000, negs_num_per_query=10, num_clusters=64, num_workers=8, optimizer='adam', output_folder='drive/MyDrive/aml_training', patience=3, queries_per_epoch=5000, recall_values=[1, 5, 10, 20], seed=0, test_datasets='pitts30k', test_only=False, train_batch_size=4, train_positives_dist_threshold=10, type='NETVLAD', val_positive_dist_threshold=25)
2022-02-01 11:39:04   The outputs are being saved in drive/MyDrive/aml_training
2022-02-01 11:39:04   Using 1 GPUs and 2 CPUs
2022-02-01 11:39:04   Loading dataset Pitts30k from folder /content/
2022-02-01 11:39:04   Images resized to 800x600
2022-02-01 11:39:04   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-02-01 11:39:04   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-02-01 11:39:04   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-02-01 11:39:05   Train only conv4 of the ResNet-18 (remove conv5), freeze the previous ones
2022-02-01 11:39:05   Using NetVlad network
2022-02-01 11:39:08   using Adam optimizer
2022-02-01 11:39:08   Output dimension of the model is 16384
2022-02-01 11:39:08   Patience: 3
2022-02-01 11:39:08   not improved num: 0
2022-02-01 11:39:08   Start training epoch: 00
2022-02-01 11:39:08   Cache: 0 / 5
2022-02-01 11:49:44   Epoch[00](0/5): current batch triplet loss = 0.0338, average epoch triplet loss = 0.0416
2022-02-01 11:49:44   Cache: 1 / 5
2022-02-01 12:00:37   Epoch[00](1/5): current batch triplet loss = 0.0467, average epoch triplet loss = 0.0384
2022-02-01 12:00:37   Cache: 2 / 5
2022-02-01 12:11:33   Epoch[00](2/5): current batch triplet loss = 0.0122, average epoch triplet loss = 0.0357
2022-02-01 12:11:33   Cache: 3 / 5
2022-02-01 12:22:28   Epoch[00](3/5): current batch triplet loss = 0.0512, average epoch triplet loss = 0.0340
2022-02-01 12:22:28   Cache: 4 / 5
2022-02-01 12:33:24   Epoch[00](4/5): current batch triplet loss = 0.0464, average epoch triplet loss = 0.0330
2022-02-01 12:33:24   Finished epoch 00 in 0:54:15, average epoch triplet loss = 0.0330
2022-02-01 12:33:24   Extracting database features for evaluation/testing
2022-02-01 12:37:11   Extracting queries features for evaluation/testing
2022-02-01 12:40:06   Calculating recalls
2022-02-01 12:40:39   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 84.6, R@5: 94.0, R@10: 96.4, R@20: 97.7
2022-02-01 12:40:39   Improved: previous best R@5 = 0.0, current R@5 = 94.0
2022-02-01 12:40:39   Start training epoch: 01
2022-02-01 12:40:39   Cache: 0 / 5
2022-02-01 12:52:54   Epoch[01](0/5): current batch triplet loss = 0.0477, average epoch triplet loss = 0.0266
2022-02-01 12:52:54   Cache: 1 / 5
2022-02-01 13:03:51   Epoch[01](1/5): current batch triplet loss = 0.0235, average epoch triplet loss = 0.0264
2022-02-01 13:03:51   Cache: 2 / 5
2022-02-01 13:14:50   Epoch[01](2/5): current batch triplet loss = 0.0432, average epoch triplet loss = 0.0256
2022-02-01 13:14:50   Cache: 3 / 5
2022-02-02 15:19:42   Arguments: Namespace(aug_prob=0.5, cache_refresh_rate=1000, colab_folder='aml_training', data_aug=None, dataset_name='pitts30k', datasets_folder='/content/', device='cuda', epochs_num=50, exp_name='default', img_height=600, img_width=800, infer_batch_size=16, lr=1e-05, margin=0.1, model_folder=None, neg_samples_num=1000, negs_num_per_query=10, num_clusters=64, num_workers=8, optimizer='adam', output_folder='drive/MyDrive/aml_training', patience=3, queries_per_epoch=5000, recall_values=[1, 5, 10, 20], seed=0, test_datasets='pitts30k', test_only=False, train_batch_size=4, train_positives_dist_threshold=10, type='NETVLAD', val_positive_dist_threshold=25)
2022-02-02 15:19:43   The outputs are being saved in drive/MyDrive/aml_training
2022-02-02 15:19:43   Using 1 GPUs and 2 CPUs
2022-02-02 15:19:43   Loading dataset Pitts30k from folder /content/
2022-02-02 15:19:43   Images resized to 800x600
2022-02-02 15:19:44   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-02-02 15:19:44   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-02-02 15:19:44   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-02-02 15:19:44   Train only conv4 of the ResNet-18 (remove conv5), freeze the previous ones
2022-02-02 15:19:44   Using NetVlad network
2022-02-02 15:19:46   using Adam optimizer
2022-02-02 15:19:46   Output dimension of the model is 16384
2022-02-02 15:19:50   Patience: 3
2022-02-02 15:19:50   not improved num: 0
2022-02-02 15:19:50   Start training epoch: 01
2022-02-02 15:19:50   Cache: 0 / 5
2022-02-02 15:39:36   Epoch[01](0/5): current batch triplet loss = 0.0214, average epoch triplet loss = 0.0236
2022-02-02 15:39:36   Cache: 1 / 5
2022-02-04 17:12:55   Arguments: Namespace(aug_prob=0.5, cache_refresh_rate=1000, colab_folder='aml_training', data_aug=None, dataset_name='pitts30k', datasets_folder='/content/', device='cuda', epochs_num=50, exp_name='default', img_height=600, img_width=800, infer_batch_size=16, lr=1e-05, margin=0.1, model_folder=None, neg_samples_num=1000, negs_num_per_query=10, num_clusters=64, num_workers=8, optimizer='adam', output_folder='drive/MyDrive/aml_training', patience=3, queries_per_epoch=5000, recall_values=[1, 5, 10, 20], seed=0, test_datasets='pitts30k', test_only=False, train_batch_size=4, train_positives_dist_threshold=10, type='NETVLAD', val_positive_dist_threshold=25)
2022-02-04 17:12:56   The outputs are being saved in drive/MyDrive/aml_training
2022-02-04 17:12:56   Using 1 GPUs and 2 CPUs
2022-02-04 17:12:56   Loading dataset Pitts30k from folder /content/
2022-02-04 17:12:56   Images resized to 800x600
2022-02-04 17:12:56   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-02-04 17:12:56   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-02-04 17:12:57   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-02-04 17:12:57   Train only conv4 of the ResNet-18 (remove conv5), freeze the previous ones
2022-02-04 17:12:57   Using NetVlad network
2022-02-04 17:12:59   using Adam optimizer
2022-02-04 17:12:59   Output dimension of the model is 16384
2022-02-04 17:13:03   Patience: 3
2022-02-04 17:13:03   not improved num: 0
2022-02-04 17:13:03   Start training epoch: 01
2022-02-04 17:13:03   Cache: 0 / 5
2022-02-04 17:31:46   Epoch[01](0/5): current batch triplet loss = 0.0214, average epoch triplet loss = 0.0236
2022-02-04 17:31:46   Cache: 1 / 5
2022-02-04 17:39:15   Arguments: Namespace(aug_prob=0.5, cache_refresh_rate=1000, colab_folder='aml_training', data_aug=None, dataset_name='pitts30k', datasets_folder='/content/', device='cuda', epochs_num=50, exp_name='default', img_height=600, img_width=800, infer_batch_size=16, lr=1e-05, margin=0.1, model_folder=None, neg_samples_num=1000, negs_num_per_query=10, num_clusters=64, num_workers=8, optimizer='adam', output_folder='drive/MyDrive/aml_training', patience=3, queries_per_epoch=5000, recall_values=[1, 5, 10, 20], seed=0, test_datasets='pitts30k', test_only=False, train_batch_size=4, train_positives_dist_threshold=10, type='NETVLAD', val_positive_dist_threshold=25)
2022-02-04 17:39:15   The outputs are being saved in drive/MyDrive/aml_training
2022-02-04 17:39:15   Using 1 GPUs and 2 CPUs
2022-02-04 17:39:15   Loading dataset Pitts30k from folder /content/
2022-02-04 17:39:16   Images resized to 800x600
2022-02-04 17:39:16   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-02-04 17:39:16   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-02-04 17:39:16   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-02-04 17:39:17   Train only conv4 of the ResNet-18 (remove conv5), freeze the previous ones
2022-02-04 17:39:17   Using NetVlad network
2022-02-04 17:39:21   using Adam optimizer
2022-02-04 17:39:21   Output dimension of the model is 16384
2022-02-04 17:39:22   Patience: 3
2022-02-04 17:39:22   not improved num: 0
2022-02-04 17:39:22   Start training epoch: 01
2022-02-04 17:39:22   Cache: 0 / 5
2022-02-04 17:58:00   Epoch[01](0/5): current batch triplet loss = 0.0214, average epoch triplet loss = 0.0236
2022-02-04 17:58:00   Cache: 1 / 5
2022-02-04 18:16:41   Epoch[01](1/5): current batch triplet loss = 0.0278, average epoch triplet loss = 0.0225
2022-02-04 18:16:41   Cache: 2 / 5
2022-02-04 18:35:21   Epoch[01](2/5): current batch triplet loss = 0.0080, average epoch triplet loss = 0.0215
2022-02-04 18:35:21   Cache: 3 / 5
2022-02-04 18:54:00   Epoch[01](3/5): current batch triplet loss = 0.0353, average epoch triplet loss = 0.0211
2022-02-04 18:54:00   Cache: 4 / 5
2022-02-04 19:12:45   Epoch[01](4/5): current batch triplet loss = 0.0323, average epoch triplet loss = 0.0209
2022-02-04 19:12:45   Finished epoch 01 in 1:33:22, average epoch triplet loss = 0.0209
2022-02-04 19:12:45   Extracting database features for evaluation/testing
2022-02-04 19:18:58   Extracting queries features for evaluation/testing
2022-02-04 19:23:28   Calculating recalls
2022-02-04 19:24:11   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 86.3, R@5: 94.8, R@10: 96.8, R@20: 98.0
2022-02-04 19:24:11   Improved: previous best R@5 = 94.0, current R@5 = 94.8
2022-02-04 19:24:13   Start training epoch: 02
2022-02-04 19:24:13   Cache: 0 / 5
2022-02-04 19:44:56   Epoch[02](0/5): current batch triplet loss = 0.0373, average epoch triplet loss = 0.0213
2022-02-04 19:44:56   Cache: 1 / 5
2022-02-06 08:43:36   Arguments: Namespace(aug_prob=0.5, cache_refresh_rate=1000, colab_folder='aml_training', data_aug=None, dataset_name='pitts30k', datasets_folder='/content/', device='cuda', epochs_num=50, exp_name='default', img_height=600, img_width=800, infer_batch_size=16, lr=1e-05, margin=0.1, model_folder=None, neg_samples_num=1000, negs_num_per_query=10, num_clusters=64, num_workers=8, optimizer='adam', output_folder='drive/MyDrive/aml_training', patience=3, queries_per_epoch=5000, recall_values=[1, 5, 10, 20], seed=0, test_datasets='pitts30k', test_only=False, train_batch_size=4, train_positives_dist_threshold=10, type='NETVLAD', val_positive_dist_threshold=25)
2022-02-06 08:43:37   The outputs are being saved in drive/MyDrive/aml_training
2022-02-06 08:43:37   Using 1 GPUs and 2 CPUs
2022-02-06 08:43:37   Loading dataset Pitts30k from folder /content/
2022-02-06 08:43:37   Images resized to 800x600
2022-02-06 08:43:37   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-02-06 08:43:37   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-02-06 08:43:38   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-02-06 08:43:38   Train only conv4 of the ResNet-18 (remove conv5), freeze the previous ones
2022-02-06 08:43:38   Using NetVlad network
2022-02-06 08:43:40   using Adam optimizer
2022-02-06 08:43:40   Output dimension of the model is 16384
2022-02-06 08:43:44   Patience: 3
2022-02-06 08:43:44   not improved num: 0
2022-02-06 08:43:44   Start training epoch: 02
2022-02-06 08:43:44   Cache: 0 / 5
2022-02-06 09:07:40   Epoch[02](0/5): current batch triplet loss = 0.0151, average epoch triplet loss = 0.0162
2022-02-06 09:07:40   Cache: 1 / 5
2022-02-06 09:31:34   Epoch[02](1/5): current batch triplet loss = 0.0208, average epoch triplet loss = 0.0158
2022-02-06 09:31:34   Cache: 2 / 5
2022-02-06 09:55:28   Epoch[02](2/5): current batch triplet loss = 0.0038, average epoch triplet loss = 0.0153
2022-02-06 09:55:28   Cache: 3 / 5
2022-02-06 10:19:24   Epoch[02](3/5): current batch triplet loss = 0.0274, average epoch triplet loss = 0.0151
2022-02-06 10:19:24   Cache: 4 / 5
2022-02-06 10:43:25   Epoch[02](4/5): current batch triplet loss = 0.0208, average epoch triplet loss = 0.0151
2022-02-06 10:43:25   Finished epoch 02 in 1:59:41, average epoch triplet loss = 0.0151
2022-02-06 10:43:25   Extracting database features for evaluation/testing
2022-02-06 10:50:22   Extracting queries features for evaluation/testing
2022-02-06 10:55:40   Calculating recalls
2022-02-06 10:56:19   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 86.6, R@5: 94.9, R@10: 96.9, R@20: 98.2
2022-02-06 10:56:19   Improved: previous best R@5 = 94.8, current R@5 = 94.9
2022-02-06 10:56:21   Start training epoch: 03
2022-02-06 10:56:21   Cache: 0 / 5
2022-02-06 11:20:24   Epoch[03](0/5): current batch triplet loss = 0.0327, average epoch triplet loss = 0.0184
2022-02-06 11:20:24   Cache: 1 / 5
2022-02-06 11:44:26   Epoch[03](1/5): current batch triplet loss = 0.0176, average epoch triplet loss = 0.0184
2022-02-06 11:44:26   Cache: 2 / 5
2022-02-06 12:08:38   Epoch[03](2/5): current batch triplet loss = 0.0172, average epoch triplet loss = 0.0179
2022-02-06 12:08:38   Cache: 3 / 5
2022-02-06 12:32:48   Epoch[03](3/5): current batch triplet loss = 0.0224, average epoch triplet loss = 0.0181
2022-02-06 12:32:48   Cache: 4 / 5
2022-02-06 12:56:54   Epoch[03](4/5): current batch triplet loss = 0.0302, average epoch triplet loss = 0.0181
2022-02-06 12:56:54   Finished epoch 03 in 2:00:33, average epoch triplet loss = 0.0181
2022-02-06 12:56:54   Extracting database features for evaluation/testing
2022-02-06 13:03:52   Extracting queries features for evaluation/testing
2022-02-06 13:09:14   Calculating recalls
2022-02-06 13:09:55   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 87.6, R@5: 95.5, R@10: 97.3, R@20: 98.3
2022-02-06 13:09:55   Improved: previous best R@5 = 94.9, current R@5 = 95.5
2022-02-06 13:09:56   Start training epoch: 04
2022-02-06 13:09:56   Cache: 0 / 5
2022-02-06 13:34:04   Epoch[04](0/5): current batch triplet loss = 0.0099, average epoch triplet loss = 0.0171
2022-02-06 13:34:04   Cache: 1 / 5
2022-02-06 13:58:02   Epoch[04](1/5): current batch triplet loss = 0.0102, average epoch triplet loss = 0.0172
2022-02-06 13:58:02   Cache: 2 / 5
2022-02-06 14:22:02   Epoch[04](2/5): current batch triplet loss = 0.0042, average epoch triplet loss = 0.0172
2022-02-06 14:22:02   Cache: 3 / 5
2022-02-06 14:46:11   Epoch[04](3/5): current batch triplet loss = 0.0057, average epoch triplet loss = 0.0168
2022-02-06 14:46:11   Cache: 4 / 5
2022-02-08 19:12:01   Arguments: Namespace(aug_prob=0.5, cache_refresh_rate=1000, colab_folder='aml_training', data_aug=None, dataset_name='pitts30k', datasets_folder='/content/', device='cuda', epochs_num=50, exp_name='default', img_height=600, img_width=800, infer_batch_size=16, lr=1e-05, margin=0.1, model_folder=None, neg_samples_num=1000, negs_num_per_query=10, num_clusters=64, num_workers=8, optimizer='adam', output_folder='drive/MyDrive/aml_training', patience=3, queries_per_epoch=5000, recall_values=[1, 5, 10, 20], seed=0, test_datasets='pitts30k', test_only=False, train_batch_size=4, train_positives_dist_threshold=10, type='NETVLAD', val_positive_dist_threshold=25)
2022-02-08 19:12:02   The outputs are being saved in drive/MyDrive/aml_training
2022-02-08 19:12:02   Using 1 GPUs and 2 CPUs
2022-02-08 19:12:02   Loading dataset Pitts30k from folder /content/
2022-02-08 19:12:02   Images resized to 800x600
2022-02-08 19:12:02   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-02-08 19:12:02   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-02-08 19:12:03   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-02-08 19:12:03   Train only conv4 of the ResNet-18 (remove conv5), freeze the previous ones
2022-02-08 19:12:03   Using NetVlad network
2022-02-08 19:12:05   using Adam optimizer
2022-02-08 19:12:05   Output dimension of the model is 16384
2022-02-08 19:12:09   Patience: 3
2022-02-08 19:12:09   not improved num: 0
2022-02-08 19:12:09   Start training epoch: 04
2022-02-08 19:12:09   Cache: 0 / 5
2022-02-08 19:31:41   Epoch[04](0/5): current batch triplet loss = 0.0053, average epoch triplet loss = 0.0105
2022-02-08 19:31:41   Cache: 1 / 5
2022-02-09 14:55:31   Arguments: Namespace(aug_prob=0.5, cache_refresh_rate=1000, colab_folder='Netvlad_resizing_800600', data_aug=None, dataset_name='pitts30k', datasets_folder='/content/', device='cuda', epochs_num=50, exp_name='default', img_height=600, img_width=800, infer_batch_size=16, lr=1e-05, margin=0.1, model_folder=None, neg_samples_num=1000, negs_num_per_query=10, num_clusters=64, num_workers=8, optimizer='adam', output_folder='drive/MyDrive/Netvlad_resizing_800600', patience=3, queries_per_epoch=5000, recall_values=[1, 5, 10, 20], seed=0, test_datasets='pitts30k,st_lucia', test_only=False, train_batch_size=4, train_positives_dist_threshold=10, type='NETVLAD', val_positive_dist_threshold=25)
2022-02-09 14:55:32   The outputs are being saved in drive/MyDrive/Netvlad_resizing_800600
2022-02-09 14:55:32   Using 1 GPUs and 2 CPUs
2022-02-09 14:55:32   Loading dataset Pitts30k from folder /content/
2022-02-09 14:55:32   Images resized to 800x600
2022-02-09 14:55:32   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-02-09 14:55:32   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-02-09 14:55:32   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-02-09 14:55:33   Train only conv4 of the ResNet-18 (remove conv5), freeze the previous ones
2022-02-09 14:55:33   Using NetVlad network
2022-02-09 14:55:36   using Adam optimizer
2022-02-09 14:55:36   Output dimension of the model is 16384
2022-02-09 14:55:37   Patience: 3
2022-02-09 14:55:37   not improved num: 0
2022-02-09 14:55:37   Start training epoch: 04
2022-02-09 14:55:37   Cache: 0 / 5
2022-02-09 15:07:00   Epoch[04](0/5): current batch triplet loss = 0.0053, average epoch triplet loss = 0.0105
2022-02-09 15:07:00   Cache: 1 / 5
2022-02-09 15:13:08   Arguments: Namespace(aug_prob=0.5, cache_refresh_rate=1000, colab_folder='Netvlad_resizing_800600', data_aug=None, dataset_name='pitts30k', datasets_folder='/content/', device='cuda', epochs_num=50, exp_name='default', img_height=600, img_width=800, infer_batch_size=16, lr=1e-05, margin=0.1, model_folder=None, neg_samples_num=1000, negs_num_per_query=10, num_clusters=64, num_workers=8, optimizer='adam', output_folder='drive/MyDrive/Netvlad_resizing_800600', patience=3, queries_per_epoch=5000, recall_values=[1, 5, 10, 20], seed=0, test_datasets='pitts30k,st_lucia', test_only=False, train_batch_size=4, train_positives_dist_threshold=10, type='NETVLAD', val_positive_dist_threshold=25)
2022-02-09 15:13:08   The outputs are being saved in drive/MyDrive/Netvlad_resizing_800600
2022-02-09 15:13:08   Using 1 GPUs and 2 CPUs
2022-02-09 15:13:08   Loading dataset Pitts30k from folder /content/
2022-02-09 15:13:08   Images resized to 800x600
2022-02-09 15:13:08   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-02-09 15:13:08   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-02-09 15:13:09   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-02-09 15:13:09   Train only conv4 of the ResNet-18 (remove conv5), freeze the previous ones
2022-02-09 15:13:09   Using NetVlad network
2022-02-09 15:13:14   using Adam optimizer
2022-02-09 15:13:14   Output dimension of the model is 16384
2022-02-09 15:13:14   Patience: 3
2022-02-09 15:13:14   not improved num: 0
2022-02-09 15:13:14   Start training epoch: 04
2022-02-09 15:13:14   Cache: 0 / 5
2022-02-09 15:23:49   Epoch[04](0/5): current batch triplet loss = 0.0053, average epoch triplet loss = 0.0105
2022-02-09 15:23:49   Cache: 1 / 5
2022-02-09 15:35:09   Epoch[04](1/5): current batch triplet loss = 0.0138, average epoch triplet loss = 0.0103
2022-02-09 15:35:09   Cache: 2 / 5
2022-02-09 15:46:08   Epoch[04](2/5): current batch triplet loss = 0.0017, average epoch triplet loss = 0.0100
2022-02-09 15:46:08   Cache: 3 / 5
2022-02-09 15:57:04   Epoch[04](3/5): current batch triplet loss = 0.0213, average epoch triplet loss = 0.0099
2022-02-09 15:57:04   Cache: 4 / 5
2022-02-09 16:08:00   Epoch[04](4/5): current batch triplet loss = 0.0106, average epoch triplet loss = 0.0101
2022-02-09 16:08:00   Finished epoch 04 in 0:54:46, average epoch triplet loss = 0.0101
2022-02-09 16:08:00   Extracting database features for evaluation/testing
2022-02-09 16:11:48   Extracting queries features for evaluation/testing
2022-02-09 16:14:42   Calculating recalls
2022-02-09 16:15:14   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 87.4, R@5: 95.2, R@10: 97.1, R@20: 98.2
2022-02-09 16:15:14   Not improved: 1 / 3: best R@5 = 95.5, current R@5 = 95.2
2022-02-09 16:15:15   Start training epoch: 05
2022-02-09 16:15:15   Cache: 0 / 5
2022-02-09 16:27:52   Epoch[05](0/5): current batch triplet loss = 0.0213, average epoch triplet loss = 0.0120
2022-02-09 16:27:52   Cache: 1 / 5
2022-02-09 16:38:52   Epoch[05](1/5): current batch triplet loss = 0.0096, average epoch triplet loss = 0.0121
2022-02-09 16:38:52   Cache: 2 / 5
2022-02-09 16:49:52   Epoch[05](2/5): current batch triplet loss = 0.0071, average epoch triplet loss = 0.0118
2022-02-09 16:49:52   Cache: 3 / 5
2022-02-09 17:00:48   Epoch[05](3/5): current batch triplet loss = 0.0173, average epoch triplet loss = 0.0120
2022-02-09 17:00:48   Cache: 4 / 5
2022-02-09 17:11:51   Epoch[05](4/5): current batch triplet loss = 0.0233, average epoch triplet loss = 0.0122
2022-02-09 17:11:51   Finished epoch 05 in 0:56:35, average epoch triplet loss = 0.0122
2022-02-09 17:11:51   Extracting database features for evaluation/testing
2022-02-09 17:15:42   Extracting queries features for evaluation/testing
2022-02-09 17:18:37   Calculating recalls
2022-02-09 17:19:09   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 87.7, R@5: 95.6, R@10: 97.4, R@20: 98.3
2022-02-09 17:19:09   Improved: previous best R@5 = 95.5, current R@5 = 95.6
2022-02-09 17:19:10   Start training epoch: 06
2022-02-09 17:19:10   Cache: 0 / 5
2022-02-09 17:32:01   Epoch[06](0/5): current batch triplet loss = 0.0101, average epoch triplet loss = 0.0135
2022-02-09 17:32:01   Cache: 1 / 5
2022-02-09 17:43:00   Epoch[06](1/5): current batch triplet loss = 0.0087, average epoch triplet loss = 0.0139
2022-02-09 17:43:00   Cache: 2 / 5
2022-02-09 17:54:04   Epoch[06](2/5): current batch triplet loss = 0.0017, average epoch triplet loss = 0.0139
2022-02-09 17:54:04   Cache: 3 / 5
2022-02-09 18:05:07   Epoch[06](3/5): current batch triplet loss = 0.0048, average epoch triplet loss = 0.0137
2022-02-09 18:05:07   Cache: 4 / 5
2022-02-09 18:16:09   Epoch[06](4/5): current batch triplet loss = 0.0037, average epoch triplet loss = 0.0137
2022-02-09 18:16:09   Finished epoch 06 in 0:56:59, average epoch triplet loss = 0.0137
2022-02-09 18:16:09   Extracting database features for evaluation/testing
2022-02-09 18:20:03   Extracting queries features for evaluation/testing
2022-02-09 18:22:58   Calculating recalls
2022-02-09 18:23:30   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 87.9, R@5: 95.7, R@10: 97.3, R@20: 98.3
2022-02-09 18:23:30   Improved: previous best R@5 = 95.6, current R@5 = 95.7
2022-02-09 18:23:30   Start training epoch: 07
2022-02-09 18:23:30   Cache: 0 / 5
2022-02-09 18:36:15   Epoch[07](0/5): current batch triplet loss = 0.0011, average epoch triplet loss = 0.0122
2022-02-09 18:36:15   Cache: 1 / 5
2022-02-10 09:04:25   Arguments: Namespace(att='default', aug_prob=0.5, cache_refresh_rate=1000, colab_folder='Netvlad_resizing_800600', data_aug=None, dataset_name='pitts30k', datasets_folder='/content/', device='cuda', epochs_num=50, exp_name='default', img_height=600, img_width=800, infer_batch_size=16, loss_function='triplet', lr=1e-05, margin=0.1, model_folder=None, neg_samples_num=1000, negs_num_per_query=10, num_clusters=64, num_workers=8, optimizer='adam', output_folder='drive/MyDrive/Netvlad_resizing_800600', patience=3, queries_per_epoch=5000, recall_values=[1, 5, 10, 20], seed=0, sos_lambda=10, test_datasets='pitts30k,st_lucia', test_only=False, train_batch_size=4, train_positives_dist_threshold=10, type='NETVLAD', val_positive_dist_threshold=25)
2022-02-10 09:04:26   The outputs are being saved in drive/MyDrive/Netvlad_resizing_800600
2022-02-10 09:04:26   Using 1 GPUs and 2 CPUs
2022-02-10 09:04:26   Loading dataset Pitts30k from folder /content/
2022-02-10 09:04:26   
Traceback (most recent call last):
  File "project_vg/train.py", line 71, in <module>
    triplets_ds = datasets_ws.TripletsDataset(args, args.datasets_folder, "pitts30k", "train", args.negs_num_per_query)
  File "/content/project_vg/datasets_ws.py", line 142, in __init__
    super().__init__(args, datasets_folder, dataset_name, split)
  File "/content/project_vg/datasets_ws.py", line 96, in __init__
    if not os.path.exists(self.dataset_folder): raise FileNotFoundError(f"Folder {self.dataset_folder} does not exist")
FileNotFoundError: Folder /content/pitts30k/images/train does not exist

2022-02-10 09:08:50   Arguments: Namespace(att='default', aug_prob=0.5, cache_refresh_rate=1000, colab_folder='Netvlad_resizing_800600', data_aug=None, dataset_name='pitts30k', datasets_folder='/content/', device='cuda', epochs_num=50, exp_name='default', img_height=600, img_width=800, infer_batch_size=16, loss_function='triplet', lr=1e-05, margin=0.1, model_folder=None, neg_samples_num=1000, negs_num_per_query=10, num_clusters=64, num_workers=8, optimizer='adam', output_folder='drive/MyDrive/Netvlad_resizing_800600', patience=3, queries_per_epoch=5000, recall_values=[1, 5, 10, 20], seed=0, sos_lambda=10, test_datasets='pitts30k,st_lucia', test_only=False, train_batch_size=4, train_positives_dist_threshold=10, type='NETVLAD', val_positive_dist_threshold=25)
2022-02-10 09:08:50   The outputs are being saved in drive/MyDrive/Netvlad_resizing_800600
2022-02-10 09:08:51   Using 1 GPUs and 2 CPUs
2022-02-10 09:08:51   Loading dataset Pitts30k from folder /content/
2022-02-10 09:08:51   Images resized to 800x600
2022-02-10 09:08:51   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-02-10 09:08:51   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-02-10 09:08:51   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-02-10 09:08:51   Train only conv4 of the ResNet-18 (remove conv5), freeze the previous ones
2022-02-10 09:08:51   Using NetVlad network
2022-02-10 09:08:54   using Adam optimizer
2022-02-10 09:08:54   Output dimension of the model is 16384
2022-02-10 09:08:55   Patience: 3
2022-02-10 09:08:55   not improved num: 0
2022-02-10 09:08:55   Start training epoch: 07
2022-02-10 09:08:55   Cache: 0 / 5
2022-02-10 09:20:19   Epoch[07](0/5): current batch triplet loss = 0.0044, average epoch triplet loss = 0.0065
2022-02-10 09:20:20   Cache: 1 / 5
2022-02-10 09:32:01   Epoch[07](1/5): current batch triplet loss = 0.0090, average epoch triplet loss = 0.0065
2022-02-10 09:32:01   Cache: 2 / 5
2022-02-10 09:44:01   Epoch[07](2/5): current batch triplet loss = 0.0014, average epoch triplet loss = 0.0063
2022-02-10 09:44:01   Cache: 3 / 5
2022-02-10 09:56:01   Epoch[07](3/5): current batch triplet loss = 0.0130, average epoch triplet loss = 0.0063
2022-02-10 09:56:01   Cache: 4 / 5
2022-02-10 10:08:08   Epoch[07](4/5): current batch triplet loss = 0.0076, average epoch triplet loss = 0.0064
2022-02-10 10:08:08   Finished epoch 07 in 0:59:13, average epoch triplet loss = 0.0064
2022-02-10 10:08:08   Extracting database features for evaluation/testing
2022-02-10 10:12:05   Extracting queries features for evaluation/testing
2022-02-10 10:15:05   Calculating recalls
2022-02-10 10:15:38   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 87.8, R@5: 95.5, R@10: 97.2, R@20: 98.3
2022-02-10 10:15:38   Not improved: 1 / 3: best R@5 = 95.7, current R@5 = 95.5
2022-02-10 10:15:39   Start training epoch: 08
2022-02-10 10:15:39   Cache: 0 / 5
2022-02-10 10:29:46   Epoch[08](0/5): current batch triplet loss = 0.0113, average epoch triplet loss = 0.0075
2022-02-10 10:29:46   Cache: 1 / 5
2022-02-10 10:42:00   Epoch[08](1/5): current batch triplet loss = 0.0034, average epoch triplet loss = 0.0077
2022-02-10 10:42:00   Cache: 2 / 5
2022-02-10 10:54:11   Epoch[08](2/5): current batch triplet loss = 0.0042, average epoch triplet loss = 0.0076
2022-02-10 10:54:11   Cache: 3 / 5
2022-02-10 11:06:25   Epoch[08](3/5): current batch triplet loss = 0.0124, average epoch triplet loss = 0.0077
2022-02-10 11:06:25   Cache: 4 / 5
2022-02-10 11:18:45   Epoch[08](4/5): current batch triplet loss = 0.0174, average epoch triplet loss = 0.0079
2022-02-10 11:18:45   Finished epoch 08 in 1:03:06, average epoch triplet loss = 0.0079
2022-02-10 11:18:45   Extracting database features for evaluation/testing
2022-02-10 11:22:46   Extracting queries features for evaluation/testing
2022-02-10 11:25:49   Calculating recalls
2022-02-10 11:26:21   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 87.9, R@5: 95.8, R@10: 97.3, R@20: 98.3
2022-02-10 11:26:21   Improved: previous best R@5 = 95.7, current R@5 = 95.8
2022-02-10 11:26:23   Start training epoch: 09
2022-02-10 11:26:23   Cache: 0 / 5
2022-02-10 11:41:44   Epoch[09](0/5): current batch triplet loss = 0.0057, average epoch triplet loss = 0.0085
2022-02-10 11:41:44   Cache: 1 / 5
2022-02-10 11:53:55   Epoch[09](1/5): current batch triplet loss = 0.0076, average epoch triplet loss = 0.0089
2022-02-10 11:53:55   Cache: 2 / 5
2022-02-10 12:06:07   Epoch[09](2/5): current batch triplet loss = 0.0008, average epoch triplet loss = 0.0091
2022-02-10 12:06:07   Cache: 3 / 5
2022-02-10 12:18:22   Epoch[09](3/5): current batch triplet loss = 0.0031, average epoch triplet loss = 0.0090
2022-02-10 12:18:22   Cache: 4 / 5
2022-02-10 12:30:32   Epoch[09](4/5): current batch triplet loss = 0.0036, average epoch triplet loss = 0.0090
2022-02-10 12:30:32   Finished epoch 09 in 1:04:08, average epoch triplet loss = 0.0090
2022-02-10 12:30:32   Extracting database features for evaluation/testing
2022-02-10 12:34:33   Extracting queries features for evaluation/testing
2022-02-10 12:37:37   Calculating recalls
2022-02-10 12:38:10   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 88.1, R@5: 95.9, R@10: 97.3, R@20: 98.4
2022-02-10 12:38:10   Improved: previous best R@5 = 95.8, current R@5 = 95.9
2022-02-10 12:38:11   Start training epoch: 10
2022-02-10 12:38:11   Cache: 0 / 5
2022-02-10 13:10:31   Arguments: Namespace(att='default', aug_prob=0.5, cache_refresh_rate=1000, colab_folder='Netvlad_resizing_800600', data_aug=None, dataset_name='pitts30k', datasets_folder='/content/', device='cuda', epochs_num=50, exp_name='default', img_height=600, img_width=800, infer_batch_size=16, loss_function='triplet', lr=1e-05, margin=0.1, model_folder=None, neg_samples_num=1000, negs_num_per_query=10, num_clusters=64, num_workers=8, optimizer='adam', output_folder='drive/MyDrive/Netvlad_resizing_800600', patience=3, queries_per_epoch=5000, recall_values=[1, 5, 10, 20], seed=0, sos_lambda=10, test_datasets='pitts30k,st_lucia', test_only=False, train_batch_size=4, train_positives_dist_threshold=10, type='NETVLAD', val_positive_dist_threshold=25)
2022-02-10 13:10:32   The outputs are being saved in drive/MyDrive/Netvlad_resizing_800600
2022-02-10 13:10:32   Using 1 GPUs and 2 CPUs
2022-02-10 13:10:32   Loading dataset Pitts30k from folder /content/
2022-02-10 13:10:32   Images resized to 800x600
2022-02-10 13:10:32   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-02-10 13:10:32   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-02-10 13:10:33   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-02-10 13:10:33   Train only conv4 of the ResNet-18 (remove conv5), freeze the previous ones
2022-02-10 13:10:33   Using NetVlad network
2022-02-10 13:10:36   using Adam optimizer
2022-02-10 13:10:36   Output dimension of the model is 16384
2022-02-10 13:10:39   Patience: 3
2022-02-10 13:10:39   not improved num: 0
2022-02-10 13:10:39   Start training epoch: 10
2022-02-10 13:10:39   Cache: 0 / 5
2022-02-10 13:21:54   Epoch[10](0/5): current batch triplet loss = 0.0003, average epoch triplet loss = 0.0042
2022-02-10 13:21:54   Cache: 1 / 5
2022-02-10 13:33:10   Epoch[10](1/5): current batch triplet loss = 0.0071, average epoch triplet loss = 0.0042
2022-02-10 13:33:10   Cache: 2 / 5
2022-02-10 13:44:56   Epoch[10](2/5): current batch triplet loss = 0.0011, average epoch triplet loss = 0.0041
2022-02-10 13:44:56   Cache: 3 / 5
2022-02-10 13:56:41   Epoch[10](3/5): current batch triplet loss = 0.0084, average epoch triplet loss = 0.0041
2022-02-10 13:56:41   Cache: 4 / 5
2022-02-10 14:08:25   Epoch[10](4/5): current batch triplet loss = 0.0063, average epoch triplet loss = 0.0042
2022-02-10 14:08:25   Finished epoch 10 in 0:57:46, average epoch triplet loss = 0.0042
2022-02-10 14:08:25   Extracting database features for evaluation/testing
2022-02-10 14:13:13   Extracting queries features for evaluation/testing
2022-02-10 14:16:27   Calculating recalls
2022-02-10 14:17:01   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 88.0, R@5: 95.9, R@10: 97.3, R@20: 98.4
2022-02-10 14:17:01   Not improved: 1 / 3: best R@5 = 95.9, current R@5 = 95.9
2022-02-10 14:17:02   Start training epoch: 11
2022-02-10 14:17:02   Cache: 0 / 5
2022-02-10 14:31:52   Epoch[11](0/5): current batch triplet loss = 0.0070, average epoch triplet loss = 0.0049
2022-02-10 14:31:52   Cache: 1 / 5
2022-02-10 14:44:12   Epoch[11](1/5): current batch triplet loss = 0.0021, average epoch triplet loss = 0.0051
2022-02-10 14:44:12   Cache: 2 / 5
2022-02-10 15:21:21   Arguments: Namespace(att='default', aug_prob=0.5, cache_refresh_rate=1000, colab_folder='Netvlad_resizing_800600', data_aug=None, dataset_name='pitts30k', datasets_folder='/content/', device='cuda', epochs_num=50, exp_name='default', img_height=600, img_width=800, infer_batch_size=16, loss_function='triplet', lr=1e-05, margin=0.1, model_folder=None, neg_samples_num=1000, negs_num_per_query=10, num_clusters=64, num_workers=8, optimizer='adam', output_folder='drive/MyDrive/Netvlad_resizing_800600', patience=3, queries_per_epoch=5000, recall_values=[1, 5, 10, 20], seed=0, sos_lambda=10, test_datasets='pitts30k,st_lucia', test_only=False, train_batch_size=4, train_positives_dist_threshold=10, type='NETVLAD', val_positive_dist_threshold=25)
2022-02-10 15:21:22   The outputs are being saved in drive/MyDrive/Netvlad_resizing_800600
2022-02-10 15:21:22   Using 1 GPUs and 2 CPUs
2022-02-10 15:21:22   Loading dataset Pitts30k from folder /content/
2022-02-10 15:21:22   Images resized to 800x600
2022-02-10 15:21:22   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-02-10 15:21:22   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-02-10 15:21:23   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-02-10 15:21:23   Train only conv4 of the ResNet-18 (remove conv5), freeze the previous ones
2022-02-10 15:21:23   Using NetVlad network
2022-02-10 15:21:26   using Adam optimizer
2022-02-10 15:21:26   Output dimension of the model is 16384
2022-02-10 15:21:30   Patience: 3
2022-02-10 15:21:30   not improved num: 1
2022-02-10 15:21:30   Start training epoch: 11
2022-02-10 15:21:30   Cache: 0 / 5
2022-02-10 15:32:42   Epoch[11](0/5): current batch triplet loss = 0.0000, average epoch triplet loss = 0.0032
2022-02-10 15:32:42   Cache: 1 / 5
2022-02-10 15:43:38   Epoch[11](1/5): current batch triplet loss = 0.0066, average epoch triplet loss = 0.0032
2022-02-10 15:43:39   Cache: 2 / 5
2022-02-10 15:54:54   Epoch[11](2/5): current batch triplet loss = 0.0012, average epoch triplet loss = 0.0031
2022-02-10 15:54:54   Cache: 3 / 5
2022-02-10 16:06:28   Epoch[11](3/5): current batch triplet loss = 0.0034, average epoch triplet loss = 0.0031
2022-02-10 16:06:28   Cache: 4 / 5
2022-02-10 16:18:06   Epoch[11](4/5): current batch triplet loss = 0.0041, average epoch triplet loss = 0.0032
2022-02-10 16:18:06   Finished epoch 11 in 0:56:36, average epoch triplet loss = 0.0032
2022-02-10 16:18:06   Extracting database features for evaluation/testing
2022-02-10 16:22:05   Extracting queries features for evaluation/testing
2022-02-10 16:25:05   Calculating recalls
2022-02-10 16:25:37   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 87.9, R@5: 95.9, R@10: 97.2, R@20: 98.4
2022-02-10 16:25:37   Not improved: 2 / 3: best R@5 = 95.9, current R@5 = 95.9
2022-02-10 16:25:38   Start training epoch: 12
2022-02-10 16:25:38   Cache: 0 / 5
2022-02-10 16:40:56   Epoch[12](0/5): current batch triplet loss = 0.0069, average epoch triplet loss = 0.0047
2022-02-10 16:40:56   Cache: 1 / 5
2022-02-10 16:52:43   Epoch[12](1/5): current batch triplet loss = 0.0023, average epoch triplet loss = 0.0050
2022-02-10 16:52:43   Cache: 2 / 5
2022-02-10 17:04:31   Epoch[12](2/5): current batch triplet loss = 0.0016, average epoch triplet loss = 0.0049
2022-02-10 17:04:31   Cache: 3 / 5
2022-02-10 17:16:13   Epoch[12](3/5): current batch triplet loss = 0.0115, average epoch triplet loss = 0.0050
2022-02-10 17:16:13   Cache: 4 / 5
2022-02-10 17:27:59   Epoch[12](4/5): current batch triplet loss = 0.0134, average epoch triplet loss = 0.0051
2022-02-10 17:27:59   Finished epoch 12 in 1:02:21, average epoch triplet loss = 0.0051
2022-02-10 17:27:59   Extracting database features for evaluation/testing
2022-02-10 17:32:07   Extracting queries features for evaluation/testing
2022-02-10 17:35:14   Calculating recalls
2022-02-10 17:35:46   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 88.1, R@5: 95.8, R@10: 97.3, R@20: 98.4
2022-02-10 17:35:46   Not improved: 3 / 3: best R@5 = 95.9, current R@5 = 95.8
2022-02-10 17:35:47   Performance did not improve for 3 epochs. Stop training.
2022-02-10 17:35:47   Best R@5: 95.9
2022-02-10 17:35:47   Trained for 13 epochs, in total in 2:14:26
2022-02-10 17:35:49   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2022-02-10 17:35:49   Extracting database features for evaluation/testing
2022-02-10 17:42:38   Extracting queries features for evaluation/testing
2022-02-10 17:47:25   Calculating recalls
2022-02-10 17:47:53   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 85.5, R@5: 92.8, R@10: 94.7, R@20: 96.3
2022-02-10 17:47:53   
Traceback (most recent call last):
  File "project_vg/train.py", line 244, in <module>
    test_ds = datasets_ws.BaseDataset(args, args.datasets_folder, test_dataset, "test")
  File "/content/project_vg/datasets_ws.py", line 96, in __init__
    if not os.path.exists(self.dataset_folder): raise FileNotFoundError(f"Folder {self.dataset_folder} does not exist")
FileNotFoundError: Folder /content/st_lucia/images/test does not exist

2022-02-10 18:15:44   Arguments: Namespace(att='default', aug_prob=0.5, cache_refresh_rate=1000, colab_folder='Netvlad_resizing_800600', data_aug=None, dataset_name='pitts30k', datasets_folder='/content/', device='cuda', epochs_num=50, exp_name='default', img_height=600, img_width=800, infer_batch_size=16, loss_function='triplet', lr=1e-05, margin=0.1, model_folder=None, neg_samples_num=1000, negs_num_per_query=10, num_clusters=64, num_workers=8, optimizer='adam', output_folder='drive/MyDrive/Netvlad_resizing_800600', patience=3, queries_per_epoch=5000, recall_values=[1, 5, 10, 20], seed=0, sos_lambda=10, test_datasets='st_lucia', test_only=False, train_batch_size=4, train_positives_dist_threshold=10, type='NETVLAD', val_positive_dist_threshold=25)
2022-02-10 18:15:45   The outputs are being saved in drive/MyDrive/Netvlad_resizing_800600
2022-02-10 18:15:45   Using 1 GPUs and 2 CPUs
2022-02-10 18:15:45   Loading dataset Pitts30k from folder /content/
2022-02-10 18:15:45   
Traceback (most recent call last):
  File "project_vg/train.py", line 71, in <module>
    triplets_ds = datasets_ws.TripletsDataset(args, args.datasets_folder, "pitts30k", "train", args.negs_num_per_query)
  File "/content/project_vg/datasets_ws.py", line 142, in __init__
    super().__init__(args, datasets_folder, dataset_name, split)
  File "/content/project_vg/datasets_ws.py", line 96, in __init__
    if not os.path.exists(self.dataset_folder): raise FileNotFoundError(f"Folder {self.dataset_folder} does not exist")
FileNotFoundError: Folder /content/pitts30k/images/train does not exist

2022-02-10 18:16:13   Arguments: Namespace(att='default', aug_prob=0.5, cache_refresh_rate=1000, colab_folder='Netvlad_resizing_800600', data_aug=None, dataset_name='pitts30k', datasets_folder='/content/', device='cuda', epochs_num=50, exp_name='default', img_height=600, img_width=800, infer_batch_size=16, loss_function='triplet', lr=1e-05, margin=0.1, model_folder=None, neg_samples_num=1000, negs_num_per_query=10, num_clusters=64, num_workers=8, optimizer='adam', output_folder='drive/MyDrive/Netvlad_resizing_800600', patience=3, queries_per_epoch=5000, recall_values=[1, 5, 10, 20], seed=0, sos_lambda=10, test_datasets='st_lucia', test_only=True, train_batch_size=4, train_positives_dist_threshold=10, type='NETVLAD', val_positive_dist_threshold=25)
2022-02-10 18:16:13   The outputs are being saved in drive/MyDrive/Netvlad_resizing_800600
2022-02-10 18:16:13   Using 1 GPUs and 2 CPUs
2022-02-10 18:16:13   Loading dataset Pitts30k from folder /content/
2022-02-10 18:16:13   
Traceback (most recent call last):
  File "project_vg/train.py", line 71, in <module>
    triplets_ds = datasets_ws.TripletsDataset(args, args.datasets_folder, "pitts30k", "train", args.negs_num_per_query)
  File "/content/project_vg/datasets_ws.py", line 142, in __init__
    super().__init__(args, datasets_folder, dataset_name, split)
  File "/content/project_vg/datasets_ws.py", line 96, in __init__
    if not os.path.exists(self.dataset_folder): raise FileNotFoundError(f"Folder {self.dataset_folder} does not exist")
FileNotFoundError: Folder /content/pitts30k/images/train does not exist

2022-02-10 18:18:33   Arguments: Namespace(att='default', aug_prob=0.5, cache_refresh_rate=1000, colab_folder='Netvlad_resizing_800600', data_aug=None, dataset_name='pitts30k', datasets_folder='/content/', device='cuda', epochs_num=50, exp_name='default', img_height=600, img_width=800, infer_batch_size=16, loss_function='triplet', lr=1e-05, margin=0.1, model_folder=None, neg_samples_num=1000, negs_num_per_query=10, num_clusters=64, num_workers=8, optimizer='adam', output_folder='drive/MyDrive/Netvlad_resizing_800600', patience=3, queries_per_epoch=5000, recall_values=[1, 5, 10, 20], seed=0, sos_lambda=10, test_datasets='st_lucia', test_only=True, train_batch_size=4, train_positives_dist_threshold=10, type='NETVLAD', val_positive_dist_threshold=25)
2022-02-10 18:18:33   The outputs are being saved in drive/MyDrive/Netvlad_resizing_800600
2022-02-10 18:18:33   Using 1 GPUs and 2 CPUs
2022-02-10 18:18:33   Loading dataset Pitts30k from folder /content/
2022-02-10 18:18:33   
Traceback (most recent call last):
  File "project_vg/train.py", line 71, in <module>
    triplets_ds = datasets_ws.TripletsDataset(args, args.datasets_folder, "pitts30k", "train", args.negs_num_per_query)
  File "/content/project_vg/datasets_ws.py", line 142, in __init__
    super().__init__(args, datasets_folder, dataset_name, split)
  File "/content/project_vg/datasets_ws.py", line 96, in __init__
    if not os.path.exists(self.dataset_folder): raise FileNotFoundError(f"Folder {self.dataset_folder} does not exist")
FileNotFoundError: Folder /content/pitts30k/images/train does not exist

2022-02-10 18:23:14   Arguments: Namespace(att='default', aug_prob=0.5, cache_refresh_rate=1000, colab_folder='Netvlad_resizing_800600', data_aug=None, dataset_name='pitts30k', datasets_folder='/content/', device='cuda', epochs_num=50, exp_name='default', img_height=600, img_width=800, infer_batch_size=16, loss_function='triplet', lr=1e-05, margin=0.1, model_folder=None, neg_samples_num=1000, negs_num_per_query=10, num_clusters=64, num_workers=8, optimizer='adam', output_folder='drive/MyDrive/Netvlad_resizing_800600', patience=3, queries_per_epoch=5000, recall_values=[1, 5, 10, 20], seed=0, sos_lambda=10, test_datasets='st_lucia', test_only=True, train_batch_size=4, train_positives_dist_threshold=10, type='NETVLAD', val_positive_dist_threshold=25)
2022-02-10 18:23:14   The outputs are being saved in drive/MyDrive/Netvlad_resizing_800600
2022-02-10 18:23:14   Using 1 GPUs and 2 CPUs
2022-02-10 18:23:14   Loading dataset Pitts30k from folder /content/
2022-02-10 18:23:14   Images resized to 800x600
2022-02-10 18:23:14   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-02-10 18:23:14   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-02-10 18:23:15   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-02-10 18:23:16   Train only conv4 of the ResNet-18 (remove conv5), freeze the previous ones
2022-02-10 18:23:16   Using NetVlad network
2022-02-10 18:23:19   
Traceback (most recent call last):
  File "project_vg/train.py", line 79, in <module>
    model = model.to(args.device)
  File "/usr/local/lib/python3.7/dist-packages/torch/nn/modules/module.py", line 612, in to
    return self._apply(convert)
  File "/usr/local/lib/python3.7/dist-packages/torch/nn/modules/module.py", line 359, in _apply
    module._apply(fn)
  File "/usr/local/lib/python3.7/dist-packages/torch/nn/modules/module.py", line 359, in _apply
    module._apply(fn)
  File "/usr/local/lib/python3.7/dist-packages/torch/nn/modules/module.py", line 381, in _apply
    param_applied = fn(param)
  File "/usr/local/lib/python3.7/dist-packages/torch/nn/modules/module.py", line 610, in convert
    return t.to(device, dtype if t.is_floating_point() else None, non_blocking)
KeyboardInterrupt

2022-02-10 18:23:31   Arguments: Namespace(att='default', aug_prob=0.5, cache_refresh_rate=1000, colab_folder='Netvlad_resizing_800600', data_aug=None, dataset_name='pitts30k', datasets_folder='/content/', device='cuda', epochs_num=50, exp_name='default', img_height=600, img_width=800, infer_batch_size=16, loss_function='triplet', lr=1e-05, margin=0.1, model_folder=None, neg_samples_num=1000, negs_num_per_query=10, num_clusters=64, num_workers=8, optimizer='adam', output_folder='drive/MyDrive/Netvlad_resizing_800600', patience=3, queries_per_epoch=5000, recall_values=[1, 5, 10, 20], seed=0, sos_lambda=10, test_datasets='pitts30k,st_lucia', test_only=False, train_batch_size=4, train_positives_dist_threshold=10, type='NETVLAD', val_positive_dist_threshold=25)
2022-02-10 18:23:31   The outputs are being saved in drive/MyDrive/Netvlad_resizing_800600
2022-02-10 18:23:31   Using 1 GPUs and 2 CPUs
2022-02-10 18:23:31   Loading dataset Pitts30k from folder /content/
2022-02-10 18:23:31   Images resized to 800x600
2022-02-10 18:23:31   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-02-10 18:23:31   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-02-10 18:23:31   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-02-10 18:23:32   Train only conv4 of the ResNet-18 (remove conv5), freeze the previous ones
2022-02-10 18:23:32   Using NetVlad network
2022-02-10 18:23:35   using Adam optimizer
2022-02-10 18:23:35   Output dimension of the model is 16384
2022-02-10 18:23:36   Patience: 3
2022-02-10 18:23:36   not improved num: 3
2022-02-10 18:23:36   Best R@5: 95.9
2022-02-10 18:23:36   Trained for 13 epochs, in total in 0:00:04
2022-02-10 18:23:36   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2022-02-10 18:23:36   Extracting database features for evaluation/testing
2022-02-10 18:27:40   Extracting queries features for evaluation/testing
2022-02-10 18:30:26   Calculating recalls
2022-02-10 18:30:58   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 85.5, R@5: 92.8, R@10: 94.7, R@20: 96.3
2022-02-10 18:30:58   Test set: < BaseDataset, st_lucia - #database: 1549; #queries: 1464 >
2022-02-10 18:30:58   Extracting database features for evaluation/testing
2022-02-10 18:32:00   Extracting queries features for evaluation/testing
2022-02-10 18:33:19   Calculating recalls
2022-02-10 18:33:21   Recalls on < BaseDataset, st_lucia - #database: 1549; #queries: 1464 >: R@1: 51.8, R@5: 66.5, R@10: 73.0, R@20: 79.8
