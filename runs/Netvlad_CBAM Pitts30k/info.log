2022-02-03 16:58:21   Arguments: Namespace(att='CBAM', aug_prob=0.5, cache_refresh_rate=1000, colab_folder='Netvlad_CBAM', data_aug=None, dataset_name='pitts30k', datasets_folder='/content/', device='cuda', epochs_num=50, exp_name='default', infer_batch_size=16, lr=1e-05, margin=0.1, neg_samples_num=1000, negs_num_per_query=10, num_clusters=64, num_workers=8, optimizer='adam', output_folder='drive/MyDrive/Netvlad_CBAM', patience=3, queries_per_epoch=5000, recall_values=[1, 5, 10, 20], seed=0, train_batch_size=4, train_positives_dist_threshold=10, type='NETVLAD', val_positive_dist_threshold=25)
2022-02-03 16:58:21   The outputs are being saved in drive/MyDrive/Netvlad_CBAM
2022-02-03 16:58:21   Using 1 GPUs and 2 CPUs
2022-02-03 16:58:22   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-02-03 16:58:22   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-02-03 16:58:22   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-02-03 16:58:24   Output dimension of the model is 16384
2022-02-03 16:58:24   Start training epoch: 00
2022-02-03 16:58:29   
Traceback (most recent call last):
  File "project_vg/train.py", line 139, in <module>
    triplets_ds.compute_triplets(args, model)
  File "/content/project_vg/datasets_ws.py", line 252, in compute_triplets
    cache = self.compute_cache(args, model, subset_ds, (len(self), args.features_dim))
  File "/content/project_vg/datasets_ws.py", line 212, in compute_cache
    features = model(images)
  File "/usr/local/lib/python3.7/dist-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/content/project_vg/network.py", line 44, in forward
    x = self.attention(x)
  File "/usr/local/lib/python3.7/dist-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/content/project_vg/cbam.py", line 92, in forward
    x_out = self.ChannelGate(x)
  File "/usr/local/lib/python3.7/dist-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/content/project_vg/cbam.py", line 42, in forward
    channel_att_raw = self.mlp( avg_pool )
  File "/usr/local/lib/python3.7/dist-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/usr/local/lib/python3.7/dist-packages/torch/nn/modules/container.py", line 117, in forward
    input = module(input)
  File "/usr/local/lib/python3.7/dist-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/usr/local/lib/python3.7/dist-packages/torch/nn/modules/linear.py", line 93, in forward
    return F.linear(input, self.weight, self.bias)
  File "/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py", line 1690, in linear
    ret = torch.addmm(bias, input, weight.t())
RuntimeError: mat1 dim 1 must match mat2 dim 0

2022-02-03 17:01:41   Arguments: Namespace(att='CBAM', aug_prob=0.5, cache_refresh_rate=1000, colab_folder='Netvlad_CBAM', data_aug=None, dataset_name='pitts30k', datasets_folder='/content/', device='cuda', epochs_num=50, exp_name='default', infer_batch_size=16, lr=1e-05, margin=0.1, neg_samples_num=1000, negs_num_per_query=10, num_clusters=64, num_workers=8, optimizer='adam', output_folder='drive/MyDrive/Netvlad_CBAM', patience=3, queries_per_epoch=5000, recall_values=[1, 5, 10, 20], seed=0, train_batch_size=4, train_positives_dist_threshold=10, type='NETVLAD', val_positive_dist_threshold=25)
2022-02-03 17:01:41   The outputs are being saved in drive/MyDrive/Netvlad_CBAM
2022-02-03 17:01:41   Using 1 GPUs and 2 CPUs
2022-02-03 17:01:41   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-02-03 17:01:41   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-02-03 17:01:42   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-02-03 17:01:44   Output dimension of the model is 16384
2022-02-03 17:01:44   Start training epoch: 00
2022-02-03 17:03:02   
Traceback (most recent call last):
  File "project_vg/train.py", line 139, in <module>
    triplets_ds.compute_triplets(args, model)
  File "/content/project_vg/datasets_ws.py", line 252, in compute_triplets
    cache = self.compute_cache(args, model, subset_ds, (len(self), args.features_dim))
  File "/content/project_vg/datasets_ws.py", line 213, in compute_cache
    cache[indexes.numpy()] = features.cpu().numpy()
KeyboardInterrupt

2022-02-03 17:04:22   Arguments: Namespace(att='CBAM', aug_prob=0.5, cache_refresh_rate=1000, colab_folder='Netvlad_CBAM', data_aug=None, dataset_name='pitts30k', datasets_folder='/content/', device='cuda', epochs_num=50, exp_name='default', infer_batch_size=16, lr=1e-05, margin=0.1, neg_samples_num=1000, negs_num_per_query=10, num_clusters=64, num_workers=8, optimizer='adam', output_folder='drive/MyDrive/Netvlad_CBAM', patience=3, queries_per_epoch=5000, recall_values=[1, 5, 10, 20], seed=0, train_batch_size=4, train_positives_dist_threshold=10, type='NETVLAD', val_positive_dist_threshold=25)
2022-02-03 17:04:22   The outputs are being saved in drive/MyDrive/Netvlad_CBAM
2022-02-03 17:04:22   Using 1 GPUs and 2 CPUs
2022-02-03 17:04:22   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-02-03 17:04:22   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-02-03 17:04:22   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-02-03 17:04:25   Output dimension of the model is 16384
2022-02-03 17:04:25   Start training epoch: 00
2022-02-03 18:09:52   Finished epoch 00 in 1:05:27, average epoch triplet loss = 0.0310
2022-02-03 18:17:01   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 86.2, R@5: 94.5, R@10: 96.7, R@20: 98.0
2022-02-03 18:17:01   Improved: previous best R@5 = 0.0, current R@5 = 94.5
2022-02-03 18:17:02   Start training epoch: 01
2022-02-03 19:24:57   Finished epoch 01 in 1:07:55, average epoch triplet loss = 0.0240
2022-02-03 19:32:01   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 87.9, R@5: 95.4, R@10: 97.2, R@20: 98.4
2022-02-03 19:32:01   Improved: previous best R@5 = 94.5, current R@5 = 95.4
2022-02-03 19:32:03   Start training epoch: 02
2022-02-04 08:56:05   Arguments: Namespace(att='CBAM', aug_prob=0.5, cache_refresh_rate=1000, colab_folder='Netvlad_CBAM', data_aug=None, dataset_name='pitts30k', datasets_folder='/content/', device='cuda', epochs_num=50, exp_name='default', infer_batch_size=16, lr=1e-05, margin=0.1, neg_samples_num=1000, negs_num_per_query=10, num_clusters=64, num_workers=8, optimizer='adam', output_folder='drive/MyDrive/Netvlad_CBAM', patience=3, queries_per_epoch=5000, recall_values=[1, 5, 10, 20], seed=0, train_batch_size=4, train_positives_dist_threshold=10, type='NETVLAD', val_positive_dist_threshold=25)
2022-02-04 08:56:05   The outputs are being saved in drive/MyDrive/Netvlad_CBAM
2022-02-04 08:56:05   Using 1 GPUs and 2 CPUs
2022-02-04 08:56:05   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-02-04 08:56:05   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-02-04 08:56:06   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-02-04 08:56:08   Output dimension of the model is 16384
2022-02-04 08:56:11   Start training epoch: 02
2022-02-04 09:57:34   Finished epoch 02 in 1:01:23, average epoch triplet loss = 0.0156
2022-02-04 10:04:19   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 87.9, R@5: 95.4, R@10: 97.3, R@20: 98.3
2022-02-04 10:04:19   Improved: previous best R@5 = 95.4, current R@5 = 95.4
2022-02-04 10:04:20   Start training epoch: 03
2022-02-04 11:07:23   Finished epoch 03 in 1:03:03, average epoch triplet loss = 0.0151
2022-02-04 11:14:07   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 88.4, R@5: 95.7, R@10: 97.3, R@20: 98.4
2022-02-04 11:14:07   Improved: previous best R@5 = 95.4, current R@5 = 95.7
2022-02-04 11:14:07   Start training epoch: 04
2022-02-04 12:18:05   Finished epoch 04 in 1:03:57, average epoch triplet loss = 0.0158
2022-02-04 12:24:53   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 88.4, R@5: 95.7, R@10: 97.4, R@20: 98.4
2022-02-04 12:24:53   Improved: previous best R@5 = 95.7, current R@5 = 95.7
2022-02-04 12:24:54   Start training epoch: 05
2022-02-04 13:10:35   Arguments: Namespace(att='CBAM', aug_prob=0.5, cache_refresh_rate=1000, colab_folder='Netvlad_CBAM', data_aug=None, dataset_name='pitts30k', datasets_folder='/content/', device='cuda', epochs_num=50, exp_name='default', infer_batch_size=16, lr=1e-05, margin=0.1, neg_samples_num=1000, negs_num_per_query=10, num_clusters=64, num_workers=8, optimizer='adam', output_folder='drive/MyDrive/Netvlad_CBAM', patience=3, queries_per_epoch=5000, recall_values=[1, 5, 10, 20], seed=0, train_batch_size=4, train_positives_dist_threshold=10, type='NETVLAD', val_positive_dist_threshold=25)
2022-02-04 13:10:35   The outputs are being saved in drive/MyDrive/Netvlad_CBAM
2022-02-04 13:10:35   Using 1 GPUs and 2 CPUs
2022-02-04 13:10:35   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-02-04 13:10:35   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-02-04 13:10:35   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-02-04 13:10:38   Output dimension of the model is 16384
2022-02-04 13:10:40   Start training epoch: 05
2022-02-04 14:29:12   Finished epoch 05 in 1:18:32, average epoch triplet loss = 0.0086
2022-02-04 14:37:49   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 88.3, R@5: 95.6, R@10: 97.2, R@20: 98.4
2022-02-04 14:37:49   Not improved: 1 / 3: best R@5 = 95.7, current R@5 = 95.6
2022-02-04 14:37:49   Start training epoch: 06
2022-02-05 08:55:01   Arguments: Namespace(att='CBAM', aug_prob=0.5, cache_refresh_rate=1000, colab_folder='Netvlad_CBAM', data_aug=None, dataset_name='pitts30k', datasets_folder='/content/', device='cuda', epochs_num=50, exp_name='default', infer_batch_size=16, lr=1e-05, margin=0.1, neg_samples_num=1000, negs_num_per_query=10, num_clusters=64, num_workers=8, optimizer='adam', output_folder='drive/MyDrive/Netvlad_CBAM', patience=3, queries_per_epoch=5000, recall_values=[1, 5, 10, 20], seed=0, train_batch_size=4, train_positives_dist_threshold=10, type='NETVLAD', val_positive_dist_threshold=25)
2022-02-05 08:55:02   The outputs are being saved in drive/MyDrive/Netvlad_CBAM
2022-02-05 08:55:02   Using 1 GPUs and 2 CPUs
2022-02-05 08:55:03   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-02-05 08:55:03   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-02-05 08:55:03   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-02-05 08:55:06   Output dimension of the model is 16384
2022-02-05 08:55:09   Start training epoch: 06
2022-02-05 09:56:07   Finished epoch 06 in 1:00:58, average epoch triplet loss = 0.0063
2022-02-05 10:02:47   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 88.2, R@5: 95.5, R@10: 97.3, R@20: 98.3
2022-02-05 10:02:47   Not improved: 2 / 3: best R@5 = 95.7, current R@5 = 95.5
2022-02-05 10:02:48   Start training epoch: 07
2022-02-05 11:05:04   Finished epoch 07 in 1:02:16, average epoch triplet loss = 0.0084
2022-02-05 11:11:41   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 88.5, R@5: 95.6, R@10: 97.5, R@20: 98.5
2022-02-05 11:11:41   Not improved: 3 / 3: best R@5 = 95.7, current R@5 = 95.6
2022-02-05 11:11:41   Performance did not improve for 3 epochs. Stop training.
2022-02-05 11:11:41   Best R@5: 95.7
2022-02-05 11:11:41   Trained for 08 epochs, in total in 2:16:40
2022-02-05 11:11:43   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2022-02-05 11:19:54   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 86.7, R@5: 93.3, R@10: 95.1, R@20: 96.4
2022-02-05 11:19:54   Test set: < BaseDataset, st_lucia - #database: 1549; #queries: 1464 >
2022-02-05 11:21:09   Recalls on < BaseDataset, st_lucia - #database: 1549; #queries: 1464 >: R@1: 55.7, R@5: 70.8, R@10: 77.2, R@20: 83.1
