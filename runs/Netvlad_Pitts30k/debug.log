2022-01-22 15:02:34   Arguments: Namespace(cache_refresh_rate=1000, colab_folder='run_1_Netvlad_default', dataset_name='pitts30k', datasets_folder='/content/', device='cuda', epochs_num=50, exp_name='default', infer_batch_size=16, lr=1e-05, margin=0.1, neg_samples_num=1000, negs_num_per_query=10, num_clusters=64, num_workers=8, output_folder='drive/MyDrive/run_1_Netvlad_default', patience=3, queries_per_epoch=5000, recall_values=[1, 5, 10, 20], seed=0, train_batch_size=4, train_positives_dist_threshold=10, type='NETVLAD', val_positive_dist_threshold=25)
2022-01-22 15:02:34   The outputs are being saved in drive/MyDrive/run_1_Netvlad_default
2022-01-22 15:02:34   Using 1 GPUs and 2 CPUs
2022-01-22 15:02:34   Loading dataset Pitts30k from folder /content/
2022-01-22 15:02:34   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-01-22 15:02:34   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-01-22 15:02:34   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-01-22 15:02:35   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2022-01-22 15:02:35   Train only conv4 of the ResNet-18 (remove conv5), freeze the previous ones
2022-01-22 15:02:35   Using NetVlad network
2022-01-22 15:02:37   Output dimension of the model is 16384
2022-01-22 15:02:37   Start training epoch: 00
2022-01-22 15:02:37   Cache: 0 / 5
2022-01-22 15:14:26   Epoch[00](0/5): current batch triplet loss = 0.0747, average epoch triplet loss = 0.0812
2022-01-22 15:14:26   Cache: 1 / 5
2022-01-22 15:26:21   Epoch[00](1/5): current batch triplet loss = 0.0888, average epoch triplet loss = 0.0790
2022-01-22 15:26:21   Cache: 2 / 5
2022-01-22 15:38:17   Epoch[00](2/5): current batch triplet loss = 0.0741, average epoch triplet loss = 0.0772
2022-01-22 15:38:17   Cache: 3 / 5
2022-01-22 15:50:19   Epoch[00](3/5): current batch triplet loss = 0.0804, average epoch triplet loss = 0.0759
2022-01-22 15:50:19   Cache: 4 / 5
2022-01-22 16:02:15   Epoch[00](4/5): current batch triplet loss = 0.0801, average epoch triplet loss = 0.0747
2022-01-22 16:02:15   Finished epoch 00 in 0:59:37, average epoch triplet loss = 0.0747
2022-01-22 16:02:15   Extracting database features for evaluation/testing
2022-01-22 16:05:30   Extracting queries features for evaluation/testing
2022-01-22 16:08:00   Calculating recalls
2022-01-22 16:08:42   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 79.7, R@5: 90.9, R@10: 94.1, R@20: 96.3
2022-01-22 16:08:42   Improved: previous best R@5 = 0.0, current R@5 = 90.9
2022-01-22 16:08:42   Start training epoch: 01
2022-01-22 16:08:42   Cache: 0 / 5
2022-01-22 16:21:15   Epoch[01](0/5): current batch triplet loss = 0.0754, average epoch triplet loss = 0.0675
2022-01-22 16:21:15   Cache: 1 / 5
2022-01-22 16:33:25   Epoch[01](1/5): current batch triplet loss = 0.0603, average epoch triplet loss = 0.0670
2022-01-22 16:33:25   Cache: 2 / 5
2022-01-22 16:45:21   Epoch[01](2/5): current batch triplet loss = 0.0749, average epoch triplet loss = 0.0661
2022-01-22 16:45:21   Cache: 3 / 5
2022-01-22 16:57:40   Epoch[01](3/5): current batch triplet loss = 0.0632, average epoch triplet loss = 0.0656
2022-01-22 16:57:40   Cache: 4 / 5
2022-01-22 17:10:01   Epoch[01](4/5): current batch triplet loss = 0.0683, average epoch triplet loss = 0.0651
2022-01-22 17:10:01   Finished epoch 01 in 1:01:18, average epoch triplet loss = 0.0651
2022-01-22 17:10:01   Extracting database features for evaluation/testing
2022-01-22 17:13:19   Extracting queries features for evaluation/testing
2022-01-22 17:15:50   Calculating recalls
2022-01-22 17:16:32   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 82.6, R@5: 92.3, R@10: 94.7, R@20: 96.6
2022-01-22 17:16:33   Improved: previous best R@5 = 90.9, current R@5 = 92.3
2022-01-22 17:16:33   Start training epoch: 02
2022-01-22 17:16:33   Cache: 0 / 5
2022-01-22 17:30:12   Epoch[02](0/5): current batch triplet loss = 0.0748, average epoch triplet loss = 0.0609
2022-01-22 17:30:12   Cache: 1 / 5
2022-01-22 17:42:23   Epoch[02](1/5): current batch triplet loss = 0.0538, average epoch triplet loss = 0.0607
2022-01-22 17:42:23   Cache: 2 / 5
2022-01-22 17:54:25   Epoch[02](2/5): current batch triplet loss = 0.0393, average epoch triplet loss = 0.0601
2022-01-22 17:54:25   Cache: 3 / 5
2022-01-22 18:06:18   Epoch[02](3/5): current batch triplet loss = 0.0490, average epoch triplet loss = 0.0593
2022-01-22 18:06:18   Cache: 4 / 5
2022-01-22 18:18:11   Epoch[02](4/5): current batch triplet loss = 0.0494, average epoch triplet loss = 0.0588
2022-01-22 18:18:11   Finished epoch 02 in 1:01:37, average epoch triplet loss = 0.0588
2022-01-22 18:18:11   Extracting database features for evaluation/testing
2022-01-22 18:21:26   Extracting queries features for evaluation/testing
2022-01-22 18:23:55   Calculating recalls
2022-01-22 18:24:37   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 82.9, R@5: 92.3, R@10: 94.6, R@20: 96.4
2022-01-22 18:24:38   Not improved: 1 / 3: best R@5 = 92.3, current R@5 = 92.3
2022-01-22 18:24:38   Start training epoch: 03
2022-01-22 18:24:38   Cache: 0 / 5
2022-01-24 08:43:04   Arguments: Namespace(cache_refresh_rate=1000, colab_folder='run_1_Netvlad_default', dataset_name='pitts30k', datasets_folder='/content/', device='cuda', epochs_num=50, exp_name='default', infer_batch_size=16, lr=1e-05, margin=0.1, neg_samples_num=1000, negs_num_per_query=10, num_clusters=64, num_workers=8, output_folder='drive/MyDrive/run_1_Netvlad_default', patience=3, queries_per_epoch=5000, recall_values=[1, 5, 10, 20], seed=0, train_batch_size=4, train_positives_dist_threshold=10, type='NETVLAD', val_positive_dist_threshold=25)
2022-01-24 08:43:05   The outputs are being saved in drive/MyDrive/run_1_Netvlad_default
2022-01-24 08:43:05   Using 1 GPUs and 2 CPUs
2022-01-24 08:43:05   Loading dataset Pitts30k from folder /content/
2022-01-24 08:43:05   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-01-24 08:43:05   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-01-24 08:43:06   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-01-24 08:43:06   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2022-01-24 08:43:06   Train only conv4 of the ResNet-18 (remove conv5), freeze the previous ones
2022-01-24 08:43:06   Using NetVlad network
2022-01-24 08:43:09   Output dimension of the model is 16384
2022-01-24 08:43:12   Start training epoch: 03
2022-01-24 08:43:12   Cache: 0 / 5
2022-01-24 08:49:29   Epoch[03](0/5): current batch triplet loss = 0.0426, average epoch triplet loss = 0.0494
2022-01-24 08:49:29   Cache: 1 / 5
2022-01-24 08:55:50   Epoch[03](1/5): current batch triplet loss = 0.0630, average epoch triplet loss = 0.0487
2022-01-24 08:55:50   Cache: 2 / 5
2022-01-24 09:02:12   Epoch[03](2/5): current batch triplet loss = 0.0380, average epoch triplet loss = 0.0476
2022-01-24 09:02:12   Cache: 3 / 5
2022-01-24 09:08:37   Epoch[03](3/5): current batch triplet loss = 0.0576, average epoch triplet loss = 0.0471
2022-01-24 09:08:37   Cache: 4 / 5
2022-01-24 09:15:04   Epoch[03](4/5): current batch triplet loss = 0.0615, average epoch triplet loss = 0.0468
2022-01-24 09:15:04   Finished epoch 03 in 0:31:52, average epoch triplet loss = 0.0468
2022-01-24 09:15:04   Extracting database features for evaluation/testing
2022-01-24 09:16:56   Extracting queries features for evaluation/testing
2022-01-24 09:18:21   Calculating recalls
2022-01-24 09:18:54   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 82.6, R@5: 91.9, R@10: 94.3, R@20: 96.1
2022-01-24 09:18:55   Not improved: 1 / 3: best R@5 = 92.3, current R@5 = 91.9
2022-01-24 09:18:55   Start training epoch: 04
2022-01-24 09:18:55   Cache: 0 / 5
2022-01-24 09:27:13   Epoch[04](0/5): current batch triplet loss = 0.0586, average epoch triplet loss = 0.0433
2022-01-24 09:27:13   Cache: 1 / 5
2022-01-24 09:33:47   Epoch[04](1/5): current batch triplet loss = 0.0325, average epoch triplet loss = 0.0434
2022-01-24 09:33:47   Cache: 2 / 5
2022-01-24 09:40:18   Epoch[04](2/5): current batch triplet loss = 0.0473, average epoch triplet loss = 0.0429
2022-01-24 09:40:18   Cache: 3 / 5
2022-01-24 09:46:47   Epoch[04](3/5): current batch triplet loss = 0.0486, average epoch triplet loss = 0.0428
2022-01-24 09:46:47   Cache: 4 / 5
2022-01-24 09:53:20   Epoch[04](4/5): current batch triplet loss = 0.0517, average epoch triplet loss = 0.0426
2022-01-24 09:53:20   Finished epoch 04 in 0:34:25, average epoch triplet loss = 0.0426
2022-01-24 09:53:20   Extracting database features for evaluation/testing
2022-01-24 09:55:14   Extracting queries features for evaluation/testing
2022-01-24 09:56:44   Calculating recalls
2022-01-24 09:57:17   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 83.1, R@5: 92.1, R@10: 94.4, R@20: 96.4
2022-01-24 09:57:18   Not improved: 2 / 3: best R@5 = 92.3, current R@5 = 92.1
2022-01-24 09:57:18   Start training epoch: 05
2022-01-24 09:57:18   Cache: 0 / 5
2022-01-24 10:06:15   Epoch[05](0/5): current batch triplet loss = 0.0526, average epoch triplet loss = 0.0398
2022-01-24 10:06:15   Cache: 1 / 5
2022-01-24 10:12:52   Epoch[05](1/5): current batch triplet loss = 0.0267, average epoch triplet loss = 0.0397
2022-01-24 10:12:52   Cache: 2 / 5
2022-01-24 10:19:24   Epoch[05](2/5): current batch triplet loss = 0.0214, average epoch triplet loss = 0.0394
2022-01-24 10:19:24   Cache: 3 / 5
2022-01-24 10:26:05   Epoch[05](3/5): current batch triplet loss = 0.0304, average epoch triplet loss = 0.0388
2022-01-24 10:26:05   Cache: 4 / 5
2022-01-24 10:32:40   Epoch[05](4/5): current batch triplet loss = 0.0194, average epoch triplet loss = 0.0385
2022-01-24 10:32:40   Finished epoch 05 in 0:35:22, average epoch triplet loss = 0.0385
2022-01-24 10:32:40   Extracting database features for evaluation/testing
2022-01-24 10:34:35   Extracting queries features for evaluation/testing
2022-01-24 10:36:03   Calculating recalls
2022-01-24 10:36:36   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 82.6, R@5: 92.0, R@10: 94.4, R@20: 96.4
2022-01-24 10:36:37   Not improved: 3 / 3: best R@5 = 92.3, current R@5 = 92.0
2022-01-24 10:36:37   Performance did not improve for 3 epochs. Stop training.
2022-01-24 10:36:37   Best R@5: 92.3
2022-01-24 10:36:37   Trained for 07 epochs, in total in 1:53:32
2022-01-24 10:36:38   Extracting database features for evaluation/testing
2022-01-24 10:39:37   Extracting queries features for evaluation/testing
2022-01-24 10:41:04   Calculating recalls
2022-01-24 10:41:34   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 80.1, R@5: 90.6, R@10: 93.2, R@20: 95.1


2022-01-25 09:54:00   Arguments: Namespace(cache_refresh_rate=1000, colab_folder='Netvlad_Pitts30k', dataset_name='pitts30k', datasets_folder='/content/', device='cuda', epochs_num=50, exp_name='default', infer_batch_size=16, lr=1e-05, margin=0.1, neg_samples_num=1000, negs_num_per_query=10, num_clusters=64, num_workers=8, output_folder='drive/MyDrive/Netvlad_Pitts30k', patience=3, queries_per_epoch=5000, recall_values=[1, 5, 10, 20], seed=0, train_batch_size=4, train_positives_dist_threshold=10, type='NETVLAD', val_positive_dist_threshold=25)
2022-01-25 09:54:00   The outputs are being saved in drive/MyDrive/Netvlad_Pitts30k
2022-01-25 09:54:00   Using 1 GPUs and 2 CPUs
2022-01-25 09:54:00   Loading dataset Pitts30k from folder /content/
2022-01-25 09:54:00   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-01-25 09:54:00   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-01-25 09:54:00   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-01-25 09:54:01   Train only conv4 of the ResNet-18 (remove conv5), freeze the previous ones
2022-01-25 09:54:01   Using NetVlad network
2022-01-25 09:54:03   Output dimension of the model is 16384
2022-01-25 09:54:03   Patience: 3
2022-01-25 09:54:03   not improved num: 3
2022-01-25 09:54:03   Best R@5: 92.3
2022-01-25 09:54:03   Trained for 06 epochs, in total in 0:00:03
2022-01-25 09:54:03   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2022-01-25 09:54:03   Extracting database features for evaluation/testing
2022-01-25 09:57:21   Extracting queries features for evaluation/testing
2022-01-25 09:59:36   Calculating recalls
2022-01-25 10:00:14   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 80.1, R@5: 90.6, R@10: 93.2, R@20: 95.1
2022-01-25 10:00:14   Test set: < BaseDataset, st_lucia - #database: 1549; #queries: 1464 >
2022-01-25 10:00:14   Extracting database features for evaluation/testing
2022-01-25 10:00:49   Extracting queries features for evaluation/testing
2022-01-25 10:01:22   Calculating recalls
2022-01-25 10:01:24   Recalls on < BaseDataset, st_lucia - #database: 1549; #queries: 1464 >: R@1: 48.4, R@5: 63.9, R@10: 70.4, R@20: 77.2
