2022-02-02 07:46:59   Arguments: Namespace(aug_prob=0.5, cache_refresh_rate=1000, colab_folder='Run_5_Netvlad_Adam_001', data_aug=None, dataset_name='pitts30k', datasets_folder='/content/', device='cuda', epochs_num=50, exp_name='default', infer_batch_size=16, lr=0.001, margin=0.1, neg_samples_num=1000, negs_num_per_query=10, num_clusters=64, num_workers=8, optimizer='adam', output_folder='drive/MyDrive/Run_5_Netvlad_Adam_001', patience=3, queries_per_epoch=5000, recall_values=[1, 5, 10, 20], seed=0, train_batch_size=4, train_positives_dist_threshold=10, type='NETVLAD', val_positive_dist_threshold=25)
2022-02-02 07:46:59   The outputs are being saved in drive/MyDrive/Run_5_Netvlad_Adam_001
2022-02-02 07:46:59   Using 1 GPUs and 2 CPUs
2022-02-02 07:46:59   Loading dataset Pitts30k from folder /content/
2022-02-02 07:46:59   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-02-02 07:46:59   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-02-02 07:47:00   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-02-02 07:47:00   Train only conv4 of the ResNet-18 (remove conv5), freeze the previous ones
2022-02-02 07:47:00   Using NetVlad network
2022-02-02 07:47:03   using Adam optimizer
2022-02-02 07:47:03   Output dimension of the model is 16384
2022-02-02 07:47:03   Patience: 3
2022-02-02 07:47:03   not improved num: 0
2022-02-02 07:47:03   Start training epoch: 00
2022-02-02 07:47:03   Cache: 0 / 5
2022-02-02 07:53:20   Epoch[00](0/5): current batch triplet loss = 0.0136, average epoch triplet loss = 0.0196
2022-02-02 07:53:20   Cache: 1 / 5
2022-02-02 07:59:46   Epoch[00](1/5): current batch triplet loss = 0.0181, average epoch triplet loss = 0.0202
2022-02-02 07:59:46   Cache: 2 / 5
2022-02-02 08:06:14   Epoch[00](2/5): current batch triplet loss = 0.0219, average epoch triplet loss = 0.0197
2022-02-02 08:06:14   Cache: 3 / 5
2022-02-02 08:12:49   Epoch[00](3/5): current batch triplet loss = 0.0366, average epoch triplet loss = 0.0194
2022-02-02 08:12:49   Cache: 4 / 5
2022-02-02 08:19:24   Epoch[00](4/5): current batch triplet loss = 0.0164, average epoch triplet loss = 0.0189
2022-02-02 08:19:24   Finished epoch 00 in 0:32:20, average epoch triplet loss = 0.0189
2022-02-02 08:19:24   Extracting database features for evaluation/testing
2022-02-02 08:21:17   Extracting queries features for evaluation/testing
2022-02-02 08:22:44   Calculating recalls
2022-02-02 08:23:15   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 79.6, R@5: 92.5, R@10: 95.1, R@20: 97.1
2022-02-02 08:23:15   Improved: previous best R@5 = 0.0, current R@5 = 92.5
2022-02-02 08:23:16   Start training epoch: 01
2022-02-02 08:23:16   Cache: 0 / 5
2022-02-02 08:32:09   Epoch[01](0/5): current batch triplet loss = 0.0218, average epoch triplet loss = 0.0140
2022-02-02 08:32:09   Cache: 1 / 5
2022-02-02 08:38:55   Epoch[01](1/5): current batch triplet loss = 0.0047, average epoch triplet loss = 0.0149
2022-02-02 08:38:55   Cache: 2 / 5
2022-02-02 08:46:14   Epoch[01](2/5): current batch triplet loss = 0.0378, average epoch triplet loss = 0.0143
2022-02-02 08:46:14   Cache: 3 / 5
2022-02-02 08:53:08   Epoch[01](3/5): current batch triplet loss = 0.0300, average epoch triplet loss = 0.0144
2022-02-02 08:53:08   Cache: 4 / 5
2022-02-02 09:00:01   Epoch[01](4/5): current batch triplet loss = 0.0451, average epoch triplet loss = 0.0144
2022-02-02 09:00:01   Finished epoch 01 in 0:36:45, average epoch triplet loss = 0.0144
2022-02-02 09:00:01   Extracting database features for evaluation/testing
2022-02-02 09:01:57   Extracting queries features for evaluation/testing
2022-02-02 09:03:27   Calculating recalls
2022-02-02 09:03:59   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 82.0, R@5: 92.6, R@10: 95.5, R@20: 97.4
2022-02-02 09:03:59   Improved: previous best R@5 = 92.5, current R@5 = 92.6
2022-02-02 09:04:00   Start training epoch: 02
2022-02-02 09:04:00   Cache: 0 / 5
2022-02-02 09:12:26   Epoch[02](0/5): current batch triplet loss = 0.0021, average epoch triplet loss = 0.0136
2022-02-02 09:12:26   Cache: 1 / 5
2022-02-02 09:19:04   Epoch[02](1/5): current batch triplet loss = 0.0092, average epoch triplet loss = 0.0134
2022-02-02 09:19:04   Cache: 2 / 5
2022-02-02 09:25:52   Epoch[02](2/5): current batch triplet loss = 0.0054, average epoch triplet loss = 0.0133
2022-02-02 09:25:52   Cache: 3 / 5
2022-02-02 09:32:27   Epoch[02](3/5): current batch triplet loss = 0.0088, average epoch triplet loss = 0.0128
2022-02-02 09:32:27   Cache: 4 / 5
2022-02-02 09:39:34   Epoch[02](4/5): current batch triplet loss = 0.0067, average epoch triplet loss = 0.0125
2022-02-02 09:39:34   Finished epoch 02 in 0:35:33, average epoch triplet loss = 0.0125
2022-02-02 09:39:34   Extracting database features for evaluation/testing
2022-02-02 09:41:31   Extracting queries features for evaluation/testing
2022-02-02 09:43:02   Calculating recalls
2022-02-02 09:43:34   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 82.6, R@5: 92.8, R@10: 95.2, R@20: 97.5
2022-02-02 09:43:34   Improved: previous best R@5 = 92.6, current R@5 = 92.8
2022-02-02 09:43:35   Start training epoch: 03
2022-02-02 09:43:35   Cache: 0 / 5
2022-02-02 09:52:51   Epoch[03](0/5): current batch triplet loss = 0.0051, average epoch triplet loss = 0.0109
2022-02-02 09:52:51   Cache: 1 / 5
2022-02-02 09:59:25   Epoch[03](1/5): current batch triplet loss = 0.0241, average epoch triplet loss = 0.0115
2022-02-02 09:59:25   Cache: 2 / 5
2022-02-02 10:06:15   Epoch[03](2/5): current batch triplet loss = 0.0025, average epoch triplet loss = 0.0113
2022-02-02 10:06:15   Cache: 3 / 5
2022-02-02 10:12:48   Epoch[03](3/5): current batch triplet loss = 0.0283, average epoch triplet loss = 0.0113
2022-02-02 10:12:48   Cache: 4 / 5
2022-02-02 10:19:46   Epoch[03](4/5): current batch triplet loss = 0.0080, average epoch triplet loss = 0.0111
2022-02-02 10:19:46   Finished epoch 03 in 0:36:11, average epoch triplet loss = 0.0111
2022-02-02 10:19:46   Extracting database features for evaluation/testing
2022-02-02 10:21:44   Extracting queries features for evaluation/testing
2022-02-02 10:23:16   Calculating recalls
2022-02-02 10:23:48   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 82.8, R@5: 92.6, R@10: 95.0, R@20: 96.9
2022-02-02 10:23:48   Not improved: 1 / 3: best R@5 = 92.8, current R@5 = 92.6
2022-02-02 10:23:49   Start training epoch: 04
2022-02-02 10:23:49   Cache: 0 / 5
2022-02-02 10:33:07   Epoch[04](0/5): current batch triplet loss = 0.0060, average epoch triplet loss = 0.0097
2022-02-02 10:33:07   Cache: 1 / 5
2022-02-02 10:39:49   Epoch[04](1/5): current batch triplet loss = 0.0035, average epoch triplet loss = 0.0095
2022-02-02 10:39:49   Cache: 2 / 5
2022-02-02 10:46:49   Epoch[04](2/5): current batch triplet loss = 0.0114, average epoch triplet loss = 0.0096
2022-02-02 10:46:49   Cache: 3 / 5
2022-02-02 10:53:20   Epoch[04](3/5): current batch triplet loss = 0.0114, average epoch triplet loss = 0.0098
2022-02-02 10:53:20   Cache: 4 / 5
2022-02-02 11:00:14   Epoch[04](4/5): current batch triplet loss = 0.0009, average epoch triplet loss = 0.0099
2022-02-02 11:00:14   Finished epoch 04 in 0:36:24, average epoch triplet loss = 0.0099
2022-02-02 11:00:14   Extracting database features for evaluation/testing
2022-02-02 11:02:09   Extracting queries features for evaluation/testing
2022-02-02 11:03:41   Calculating recalls
2022-02-02 11:04:13   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 83.4, R@5: 92.8, R@10: 95.4, R@20: 97.1
2022-02-02 11:04:13   Improved: previous best R@5 = 92.8, current R@5 = 92.8
2022-02-02 11:04:15   Start training epoch: 05
2022-02-02 11:04:15   Cache: 0 / 5
2022-02-02 11:13:37   Epoch[05](0/5): current batch triplet loss = 0.0026, average epoch triplet loss = 0.0096
2022-02-02 11:13:37   Cache: 1 / 5
2022-02-02 11:20:15   Epoch[05](1/5): current batch triplet loss = 0.0171, average epoch triplet loss = 0.0089
2022-02-02 11:20:15   Cache: 2 / 5
2022-02-04 08:55:06   Arguments: Namespace(aug_prob=0.5, cache_refresh_rate=1000, colab_folder='Run_5_Netvlad_Adam_001', data_aug=None, dataset_name='pitts30k', datasets_folder='/content/', device='cuda', epochs_num=50, exp_name='default', infer_batch_size=16, lr=0.001, margin=0.1, neg_samples_num=1000, negs_num_per_query=10, num_clusters=64, num_workers=8, optimizer='adam', output_folder='drive/MyDrive/Run_5_Netvlad_Adam_001', patience=3, queries_per_epoch=5000, recall_values=[1, 5, 10, 20], seed=0, train_batch_size=4, train_positives_dist_threshold=10, type='NETVLAD', val_positive_dist_threshold=25)
2022-02-04 08:55:06   The outputs are being saved in drive/MyDrive/Run_5_Netvlad_Adam_001
2022-02-04 08:55:06   Using 1 GPUs and 2 CPUs
2022-02-04 08:55:06   Loading dataset Pitts30k from folder /content/
2022-02-04 08:55:07   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-02-04 08:55:07   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-02-04 08:55:07   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-02-04 08:55:07   Train only conv4 of the ResNet-18 (remove conv5), freeze the previous ones
2022-02-04 08:55:07   Using NetVlad network
2022-02-04 08:55:09   using Adam optimizer
2022-02-04 08:55:09   Output dimension of the model is 16384
2022-02-04 08:55:13   Patience: 3
2022-02-04 08:55:13   not improved num: 0
2022-02-04 08:55:13   Start training epoch: 05
2022-02-04 08:55:13   Cache: 0 / 5
2022-02-04 09:07:49   Epoch[05](0/5): current batch triplet loss = 0.0024, average epoch triplet loss = 0.0046
2022-02-04 09:07:49   Cache: 1 / 5
2022-02-04 09:13:20   
2022-02-04 11:57:27   Arguments: Namespace(aug_prob=0.5, cache_refresh_rate=1000, colab_folder='Run_5_Netvlad_Adam_001', data_aug=None, dataset_name='pitts30k', datasets_folder='/content/', device='cuda', epochs_num=50, exp_name='default', infer_batch_size=16, lr=0.001, margin=0.1, neg_samples_num=1000, negs_num_per_query=10, num_clusters=64, num_workers=8, optimizer='adam', output_folder='drive/MyDrive/Run_5_Netvlad_Adam_001', patience=3, queries_per_epoch=5000, recall_values=[1, 5, 10, 20], seed=0, train_batch_size=4, train_positives_dist_threshold=10, type='NETVLAD', val_positive_dist_threshold=25)
2022-02-04 11:57:28   The outputs are being saved in drive/MyDrive/Run_5_Netvlad_Adam_001
2022-02-04 11:57:28   Using 1 GPUs and 2 CPUs
2022-02-04 11:57:28   Loading dataset Pitts30k from folder /content/
2022-02-04 11:57:28   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-02-04 11:57:28   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-02-04 11:57:28   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-02-04 11:57:29   Train only conv4 of the ResNet-18 (remove conv5), freeze the previous ones
2022-02-04 11:57:29   Using NetVlad network
2022-02-04 11:57:31   using Adam optimizer
2022-02-04 11:57:31   Output dimension of the model is 16384
2022-02-04 11:57:35   Patience: 3
2022-02-04 11:57:35   not improved num: 0
2022-02-04 11:57:35   Start training epoch: 05
2022-02-04 11:57:35   Cache: 0 / 5
2022-02-04 12:11:28   Epoch[05](0/5): current batch triplet loss = 0.0024, average epoch triplet loss = 0.0046
2022-02-04 12:11:28   Cache: 1 / 5
2022-02-04 12:25:24   Epoch[05](1/5): current batch triplet loss = 0.0104, average epoch triplet loss = 0.0044
2022-02-04 12:25:24   Cache: 2 / 5
2022-02-04 12:39:17   Epoch[05](2/5): current batch triplet loss = 0.0083, average epoch triplet loss = 0.0044
2022-02-04 12:39:17   Cache: 3 / 5
2022-02-04 12:53:03   Epoch[05](3/5): current batch triplet loss = 0.0082, average epoch triplet loss = 0.0045
2022-02-04 12:53:03   Cache: 4 / 5
2022-02-04 13:06:53   Epoch[05](4/5): current batch triplet loss = 0.0187, average epoch triplet loss = 0.0045
2022-02-04 13:06:53   Finished epoch 05 in 1:09:18, average epoch triplet loss = 0.0045
2022-02-04 13:06:53   Extracting database features for evaluation/testing
2022-02-04 13:11:06   Extracting queries features for evaluation/testing
2022-02-04 13:15:12   Calculating recalls
2022-02-04 13:15:56   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 83.0, R@5: 93.1, R@10: 95.5, R@20: 97.3
2022-02-04 13:15:56   Improved: previous best R@5 = 92.8, current R@5 = 93.1
2022-02-04 13:15:57   Start training epoch: 06
2022-02-04 13:15:57   Cache: 0 / 5
2022-02-04 13:31:15   Epoch[06](0/5): current batch triplet loss = 0.0111, average epoch triplet loss = 0.0049
2022-02-04 13:31:15   Cache: 1 / 5
2022-02-04 13:45:12   Epoch[06](1/5): current batch triplet loss = 0.0013, average epoch triplet loss = 0.0055
2022-02-04 13:45:12   Cache: 2 / 5
2022-02-04 13:59:15   Epoch[06](2/5): current batch triplet loss = 0.0213, average epoch triplet loss = 0.0052
2022-02-04 13:59:15   Cache: 3 / 5
2022-02-04 14:13:18   Epoch[06](3/5): current batch triplet loss = 0.0140, average epoch triplet loss = 0.0054
2022-02-04 14:13:18   Cache: 4 / 5
2022-02-04 14:27:21   Epoch[06](4/5): current batch triplet loss = 0.0090, average epoch triplet loss = 0.0054
2022-02-04 14:27:21   Finished epoch 06 in 1:11:24, average epoch triplet loss = 0.0054
2022-02-04 14:27:21   Extracting database features for evaluation/testing
2022-02-04 14:31:15   Extracting queries features for evaluation/testing
2022-02-04 14:34:12   Calculating recalls
2022-02-04 14:34:54   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 81.6, R@5: 92.7, R@10: 95.4, R@20: 96.9
2022-02-04 14:34:54   Not improved: 1 / 3: best R@5 = 93.1, current R@5 = 92.7
2022-02-04 14:34:55   Start training epoch: 07
2022-02-04 14:34:55   Cache: 0 / 5
2022-02-04 14:50:34   Epoch[07](0/5): current batch triplet loss = 0.0009, average epoch triplet loss = 0.0046
2022-02-04 14:50:34   Cache: 1 / 5
2022-02-04 15:04:20   Epoch[07](1/5): current batch triplet loss = 0.0055, average epoch triplet loss = 0.0048
2022-02-04 15:04:20   Cache: 2 / 5
2022-02-04 15:18:05   Epoch[07](2/5): current batch triplet loss = 0.0008, average epoch triplet loss = 0.0053
2022-02-04 15:18:05   Cache: 3 / 5
2022-02-04 15:31:52   Epoch[07](3/5): current batch triplet loss = 0.0056, average epoch triplet loss = 0.0054
2022-02-04 15:31:52   Cache: 4 / 5
2022-02-04 15:45:39   Epoch[07](4/5): current batch triplet loss = 0.0025, average epoch triplet loss = 0.0053
2022-02-04 15:45:39   Finished epoch 07 in 1:10:43, average epoch triplet loss = 0.0053
2022-02-04 15:45:39   Extracting database features for evaluation/testing
2022-02-04 15:49:31   Extracting queries features for evaluation/testing
2022-02-04 15:52:28   Calculating recalls
2022-02-04 15:53:10   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 81.3, R@5: 92.5, R@10: 95.2, R@20: 96.9
2022-02-04 15:53:10   Not improved: 2 / 3: best R@5 = 93.1, current R@5 = 92.5
2022-02-04 15:53:11   Start training epoch: 08
2022-02-04 15:53:11   Cache: 0 / 5
2022-02-04 16:08:52   Epoch[08](0/5): current batch triplet loss = 0.0005, average epoch triplet loss = 0.0046
2022-02-04 16:08:52   Cache: 1 / 5
2022-02-05 15:04:26   Arguments: Namespace(att='default', aug_prob=0.5, cache_refresh_rate=1000, colab_folder='Run_5_Netvlad_Adam_001', data_aug=None, dataset_name='pitts30k', datasets_folder='/content/', device='cuda', epochs_num=50, exp_name='default', infer_batch_size=16, lr=0.001, margin=0.1, neg_samples_num=1000, negs_num_per_query=10, num_clusters=64, num_workers=8, optimizer='adam', output_folder='drive/MyDrive/Run_5_Netvlad_Adam_001', patience=3, queries_per_epoch=5000, recall_values=[1, 5, 10, 20], seed=0, train_batch_size=4, train_positives_dist_threshold=10, type='NETVLAD', val_positive_dist_threshold=25)
2022-02-05 15:04:27   The outputs are being saved in drive/MyDrive/Run_5_Netvlad_Adam_001
2022-02-05 15:04:27   Using 1 GPUs and 2 CPUs
2022-02-05 15:04:27   Loading dataset Pitts30k from folder /content/
2022-02-05 15:04:27   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-02-05 15:04:27   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-02-05 15:04:27   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-02-05 15:04:28   Train only conv4 of the ResNet-18 (remove conv5), freeze the previous ones
2022-02-05 15:04:28   Using NetVlad network
2022-02-05 15:04:29   using Adam optimizer
2022-02-05 15:04:29   Output dimension of the model is 16384
2022-02-05 15:04:31   Patience: 3
2022-02-05 15:04:31   not improved num: 2
2022-02-05 15:04:31   Start training epoch: 08
2022-02-05 15:04:31   Cache: 0 / 5
2022-02-05 15:16:31   Epoch[08](0/5): current batch triplet loss = 0.0009, average epoch triplet loss = 0.0025
2022-02-05 15:16:31   Cache: 1 / 5
2022-02-05 15:28:34   Epoch[08](1/5): current batch triplet loss = 0.0039, average epoch triplet loss = 0.0025
2022-02-05 15:28:34   Cache: 2 / 5
2022-02-05 15:40:39   Epoch[08](2/5): current batch triplet loss = 0.0000, average epoch triplet loss = 0.0025
2022-02-05 15:40:39   Cache: 3 / 5
2022-02-05 15:52:43   Epoch[08](3/5): current batch triplet loss = 0.0008, average epoch triplet loss = 0.0025
2022-02-05 15:52:43   Cache: 4 / 5
2022-02-05 16:04:50   Epoch[08](4/5): current batch triplet loss = 0.0047, average epoch triplet loss = 0.0026
2022-02-05 16:04:50   Finished epoch 08 in 1:00:19, average epoch triplet loss = 0.0026
2022-02-05 16:04:50   Extracting database features for evaluation/testing
2022-02-05 16:08:11   Extracting queries features for evaluation/testing
2022-02-05 16:10:46   Calculating recalls
2022-02-05 16:11:28   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 82.2, R@5: 92.8, R@10: 95.4, R@20: 97.3
2022-02-05 16:11:28   Not improved: 3 / 3: best R@5 = 93.1, current R@5 = 92.8
2022-02-05 16:11:29   Performance did not improve for 3 epochs. Stop training.
2022-02-05 16:11:29   Best R@5: 93.1
2022-02-05 16:11:29   Trained for 09 epochs, in total in 1:07:02
2022-02-05 16:11:30   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2022-02-05 16:11:30   Extracting database features for evaluation/testing
2022-02-05 16:15:50   Extracting queries features for evaluation/testing
2022-02-05 16:18:52   Calculating recalls
2022-02-05 16:19:30   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 79.5, R@5: 89.6, R@10: 92.3, R@20: 94.3
2022-02-05 16:19:30   Test set: < BaseDataset, st_lucia - #database: 1549; #queries: 1464 >
2022-02-05 16:19:30   Extracting database features for evaluation/testing
2022-02-05 16:20:06   Extracting queries features for evaluation/testing
2022-02-05 16:20:39   Calculating recalls
2022-02-05 16:20:41   Recalls on < BaseDataset, st_lucia - #database: 1549; #queries: 1464 >: R@1: 39.2, R@5: 57.7, R@10: 64.5, R@20: 73.8
