2022-01-28 15:14:08   Arguments: Namespace(cache_refresh_rate=1000, colab_folder='Run_4_Netvlad_SGD_001', dataset_name='pitts30k', datasets_folder='/content/', device='cuda', epochs_num=50, exp_name='default', infer_batch_size=16, lr=0.001, margin=0.1, neg_samples_num=1000, negs_num_per_query=10, num_clusters=64, num_workers=8, optim='adam', optimizer='SGD', output_folder='drive/MyDrive/Run_4_Netvlad_SGD_001', patience=3, queries_per_epoch=5000, recall_values=[1, 5, 10, 20], seed=0, train_batch_size=4, train_positives_dist_threshold=10, type='NETVLAD', val_positive_dist_threshold=25)
2022-01-28 15:14:08   The outputs are being saved in drive/MyDrive/Run_4_Netvlad_SGD_001
2022-01-28 15:14:08   Using 1 GPUs and 2 CPUs
2022-01-28 15:14:08   Loading dataset Pitts30k from folder /content/
2022-01-28 15:14:08   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-01-28 15:14:08   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-01-28 15:14:08   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-01-28 15:14:09   Train only conv4 of the ResNet-18 (remove conv5), freeze the previous ones
2022-01-28 15:14:09   Using NetVlad network
2022-01-28 15:14:11   Using SGD optimizer
2022-01-28 15:17:10   Arguments: Namespace(cache_refresh_rate=1000, colab_folder='Run_4_Netvlad_SGD_001', dataset_name='pitts30k', datasets_folder='/content/', device='cuda', epochs_num=50, exp_name='default', infer_batch_size=16, lr=0.001, margin=0.1, neg_samples_num=1000, negs_num_per_query=10, num_clusters=64, num_workers=8, optim='adam', optimizer='SGD', output_folder='drive/MyDrive/Run_4_Netvlad_SGD_001', patience=3, queries_per_epoch=5000, recall_values=[1, 5, 10, 20], seed=0, train_batch_size=4, train_positives_dist_threshold=10, type='NETVLAD', val_positive_dist_threshold=25)
2022-01-28 15:17:10   The outputs are being saved in drive/MyDrive/Run_4_Netvlad_SGD_001
2022-01-28 15:17:10   Using 1 GPUs and 2 CPUs
2022-01-28 15:17:10   Loading dataset Pitts30k from folder /content/
2022-01-28 15:17:10   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-01-28 15:17:10   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-01-28 15:17:11   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-01-28 15:17:12   Train only conv4 of the ResNet-18 (remove conv5), freeze the previous ones
2022-01-28 15:17:12   Using NetVlad network
2022-01-28 15:17:14   Using SGD optimizer
2022-01-28 15:17:14   Output dimension of the model is 16384
2022-01-28 15:17:15   Patience: 3
2022-01-28 15:17:15   not improved num: 0
2022-01-28 15:17:15   Start training epoch: 00
2022-01-28 15:17:15   Cache: 0 / 5
2022-01-28 15:29:04   Epoch[00](0/5): current batch triplet loss = 0.0442, average epoch triplet loss = 0.0405
2022-01-28 15:29:04   Cache: 1 / 5
2022-01-28 15:41:07   Epoch[00](1/5): current batch triplet loss = 0.0516, average epoch triplet loss = 0.0376
2022-01-28 15:41:07   Cache: 2 / 5
2022-01-28 15:53:18   Epoch[00](2/5): current batch triplet loss = 0.0210, average epoch triplet loss = 0.0358
2022-01-28 15:53:18   Cache: 3 / 5
2022-01-28 16:05:39   Epoch[00](3/5): current batch triplet loss = 0.0501, average epoch triplet loss = 0.0347
2022-01-28 16:05:39   Cache: 4 / 5
2022-01-28 16:17:54   Epoch[00](4/5): current batch triplet loss = 0.0583, average epoch triplet loss = 0.0342
2022-01-28 16:17:54   Finished epoch 00 in 1:00:39, average epoch triplet loss = 0.0342
2022-01-28 16:17:55   Extracting database features for evaluation/testing
2022-01-28 16:21:13   Extracting queries features for evaluation/testing
2022-01-28 16:23:45   Calculating recalls
2022-01-28 16:24:27   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 84.4, R@5: 93.7, R@10: 96.0, R@20: 97.7
2022-01-28 16:24:27   Improved: previous best R@5 = 0.0, current R@5 = 93.7
2022-01-28 16:24:27   Start training epoch: 01
2022-01-28 16:24:27   Cache: 0 / 5
2022-01-28 16:36:54   Epoch[01](0/5): current batch triplet loss = 0.0591, average epoch triplet loss = 0.0300
2022-01-28 16:36:54   Cache: 1 / 5
2022-01-28 16:49:20   Epoch[01](1/5): current batch triplet loss = 0.0305, average epoch triplet loss = 0.0301
2022-01-28 16:49:20   Cache: 2 / 5
2022-01-28 17:01:34   Epoch[01](2/5): current batch triplet loss = 0.0495, average epoch triplet loss = 0.0299
2022-01-28 17:01:34   Cache: 3 / 5
2022-01-28 17:13:27   Epoch[01](3/5): current batch triplet loss = 0.0292, average epoch triplet loss = 0.0300
2022-01-28 17:13:27   Cache: 4 / 5
2022-01-28 17:25:19   Epoch[01](4/5): current batch triplet loss = 0.0597, average epoch triplet loss = 0.0302
2022-01-28 17:25:19   Finished epoch 01 in 1:00:52, average epoch triplet loss = 0.0302
2022-01-28 17:25:19   Extracting database features for evaluation/testing
2022-01-28 17:28:37   Extracting queries features for evaluation/testing
2022-01-28 17:31:09   Calculating recalls
2022-01-28 17:31:50   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 86.2, R@5: 94.8, R@10: 97.0, R@20: 98.3
2022-01-28 17:31:50   Improved: previous best R@5 = 93.7, current R@5 = 94.8
2022-01-28 17:31:51   Start training epoch: 02
2022-01-28 17:31:51   Cache: 0 / 5
2022-01-29 14:06:35   Arguments: Namespace(aug_prob=0.5, cache_refresh_rate=1000, colab_folder='Run_4_Netvlad_SGD_001', data_aug=None, dataset_name='pitts30k', datasets_folder='/content/', device='cuda', epochs_num=50, exp_name='default', infer_batch_size=16, lr=0.001, margin=0.1, neg_samples_num=1000, negs_num_per_query=10, num_clusters=64, num_workers=8, optimizer='SGD', output_folder='drive/MyDrive/Run_4_Netvlad_SGD_001', patience=3, queries_per_epoch=5000, recall_values=[1, 5, 10, 20], seed=0, train_batch_size=4, train_positives_dist_threshold=10, type='NETVLAD', val_positive_dist_threshold=25)
2022-01-29 14:06:36   The outputs are being saved in drive/MyDrive/Run_4_Netvlad_SGD_001
2022-01-29 14:06:36   Using 1 GPUs and 2 CPUs
2022-01-29 14:06:36   Loading dataset Pitts30k from folder /content/
2022-01-29 14:06:36   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-01-29 14:06:36   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-01-29 14:06:37   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-01-29 14:06:37   Train only conv4 of the ResNet-18 (remove conv5), freeze the previous ones
2022-01-29 14:06:37   Using NetVlad network
2022-01-29 14:06:40   Using SGD optimizer
2022-01-29 14:06:40   Output dimension of the model is 16384
2022-01-29 14:06:42   Patience: 3
2022-01-29 14:06:42   not improved num: 0
2022-01-29 14:06:42   Start training epoch: 02
2022-01-29 14:06:42   Cache: 0 / 5
2022-01-29 14:12:58   Epoch[02](0/5): current batch triplet loss = 0.0321, average epoch triplet loss = 0.0239
2022-01-29 14:12:58   Cache: 1 / 5
2022-01-29 14:19:20   Epoch[02](1/5): current batch triplet loss = 0.0320, average epoch triplet loss = 0.0233
2022-01-29 14:19:20   Cache: 2 / 5
2022-01-29 14:25:42   Epoch[02](2/5): current batch triplet loss = 0.0136, average epoch triplet loss = 0.0230
2022-01-29 14:25:42   Cache: 3 / 5
2022-01-29 14:32:02   Epoch[02](3/5): current batch triplet loss = 0.0394, average epoch triplet loss = 0.0232
2022-01-29 14:32:02   Cache: 4 / 5
2022-01-29 14:38:24   Epoch[02](4/5): current batch triplet loss = 0.0476, average epoch triplet loss = 0.0234
2022-01-29 14:38:24   Finished epoch 02 in 0:31:41, average epoch triplet loss = 0.0234
2022-01-29 14:38:24   Extracting database features for evaluation/testing
2022-01-29 14:40:44   Extracting queries features for evaluation/testing
2022-01-29 14:42:19   Calculating recalls
2022-01-29 14:42:52   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 86.6, R@5: 95.2, R@10: 97.1, R@20: 98.2
2022-01-29 14:42:52   Improved: previous best R@5 = 94.8, current R@5 = 95.2
2022-01-29 14:42:53   Start training epoch: 03
2022-01-29 14:42:53   Cache: 0 / 5
2022-01-29 14:51:15   Epoch[03](0/5): current batch triplet loss = 0.0533, average epoch triplet loss = 0.0237
2022-01-29 14:51:15   Cache: 1 / 5
2022-01-29 14:57:40   Epoch[03](1/5): current batch triplet loss = 0.0264, average epoch triplet loss = 0.0238
2022-01-29 14:57:40   Cache: 2 / 5
2022-01-29 15:04:09   Epoch[03](2/5): current batch triplet loss = 0.0436, average epoch triplet loss = 0.0237
2022-01-29 15:04:09   Cache: 3 / 5
2022-01-29 15:10:34   Epoch[03](3/5): current batch triplet loss = 0.0283, average epoch triplet loss = 0.0239
2022-01-29 15:10:34   Cache: 4 / 5
2022-01-29 15:17:06   Epoch[03](4/5): current batch triplet loss = 0.0486, average epoch triplet loss = 0.0242
2022-01-29 15:17:06   Finished epoch 03 in 0:34:13, average epoch triplet loss = 0.0242
2022-01-29 15:17:06   Extracting database features for evaluation/testing
2022-01-29 15:18:58   Extracting queries features for evaluation/testing
2022-01-29 15:20:25   Calculating recalls
2022-01-29 15:20:57   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 87.3, R@5: 95.6, R@10: 97.3, R@20: 98.4
2022-01-29 15:20:57   Improved: previous best R@5 = 95.2, current R@5 = 95.6
2022-01-29 15:20:57   Start training epoch: 04
2022-01-29 15:20:57   Cache: 0 / 5
2022-01-29 15:29:35   Epoch[04](0/5): current batch triplet loss = 0.0214, average epoch triplet loss = 0.0246
2022-01-29 15:29:35   Cache: 1 / 5
2022-01-29 15:36:06   Epoch[04](1/5): current batch triplet loss = 0.0123, average epoch triplet loss = 0.0251
2022-01-29 15:36:06   Cache: 2 / 5
2022-01-29 15:42:40   Epoch[04](2/5): current batch triplet loss = 0.0122, average epoch triplet loss = 0.0248
2022-01-29 15:42:40   Cache: 3 / 5
2022-01-29 15:49:18   Epoch[04](3/5): current batch triplet loss = 0.0118, average epoch triplet loss = 0.0246
2022-01-29 15:49:18   Cache: 4 / 5
2022-01-29 15:55:49   Epoch[04](4/5): current batch triplet loss = 0.0115, average epoch triplet loss = 0.0247
2022-01-29 15:55:49   Finished epoch 04 in 0:34:51, average epoch triplet loss = 0.0247
2022-01-29 15:55:49   Extracting database features for evaluation/testing
2022-01-29 15:57:41   Extracting queries features for evaluation/testing
2022-01-29 15:59:08   Calculating recalls
2022-01-29 15:59:40   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 87.7, R@5: 95.8, R@10: 97.5, R@20: 98.4
2022-01-29 15:59:40   Improved: previous best R@5 = 95.6, current R@5 = 95.8
2022-01-29 15:59:40   Start training epoch: 05
2022-01-29 15:59:40   Cache: 0 / 5
2022-01-29 16:08:18   Epoch[05](0/5): current batch triplet loss = 0.0128, average epoch triplet loss = 0.0224
2022-01-29 16:08:18   Cache: 1 / 5
2022-01-29 16:14:49   Epoch[05](1/5): current batch triplet loss = 0.0311, average epoch triplet loss = 0.0236
2022-01-29 16:14:49   Cache: 2 / 5
2022-01-29 16:21:19   Epoch[05](2/5): current batch triplet loss = 0.0226, average epoch triplet loss = 0.0245
2022-01-29 16:21:19   Cache: 3 / 5
2022-01-29 16:27:46   Epoch[05](3/5): current batch triplet loss = 0.0636, average epoch triplet loss = 0.0245
2022-01-29 16:27:46   Cache: 4 / 5
2022-01-29 16:34:23   Epoch[05](4/5): current batch triplet loss = 0.0250, average epoch triplet loss = 0.0249
2022-01-29 16:34:23   Finished epoch 05 in 0:34:43, average epoch triplet loss = 0.0249
2022-01-29 16:34:23   Extracting database features for evaluation/testing
2022-01-29 16:36:16   Extracting queries features for evaluation/testing
2022-01-29 16:37:43   Calculating recalls
2022-01-29 16:38:16   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 87.9, R@5: 95.8, R@10: 97.5, R@20: 98.4
2022-01-29 16:38:16   Improved: previous best R@5 = 95.8, current R@5 = 95.8
2022-01-29 16:38:16   Start training epoch: 06
2022-01-29 16:38:16   Cache: 0 / 5
2022-01-29 16:46:59   Epoch[06](0/5): current batch triplet loss = 0.0055, average epoch triplet loss = 0.0245
2022-01-29 16:46:59   Cache: 1 / 5
2022-01-29 16:53:30   Epoch[06](1/5): current batch triplet loss = 0.0132, average epoch triplet loss = 0.0241
2022-01-29 16:53:30   Cache: 2 / 5
2022-01-29 17:00:02   Epoch[06](2/5): current batch triplet loss = 0.0283, average epoch triplet loss = 0.0240
2022-01-29 17:00:02   Cache: 3 / 5
2022-01-29 17:06:29   Epoch[06](3/5): current batch triplet loss = 0.0302, average epoch triplet loss = 0.0245
2022-01-29 17:06:29   Cache: 4 / 5
2022-01-29 17:13:01   Epoch[06](4/5): current batch triplet loss = 0.0152, average epoch triplet loss = 0.0248
2022-01-29 17:13:01   Finished epoch 06 in 0:34:44, average epoch triplet loss = 0.0248
2022-01-29 17:13:01   Extracting database features for evaluation/testing
2022-01-29 17:14:53   Extracting queries features for evaluation/testing
2022-01-29 17:16:20   Calculating recalls
2022-01-29 17:16:52   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 88.1, R@5: 96.1, R@10: 97.6, R@20: 98.4
2022-01-29 17:16:52   Improved: previous best R@5 = 95.8, current R@5 = 96.1
2022-01-29 17:16:53   Start training epoch: 07
2022-01-29 17:16:53   Cache: 0 / 5
2022-01-29 17:25:14   Epoch[07](0/5): current batch triplet loss = 0.0133, average epoch triplet loss = 0.0252
2022-01-29 17:25:14   Cache: 1 / 5
2022-01-29 17:31:45   Epoch[07](1/5): current batch triplet loss = 0.0386, average epoch triplet loss = 0.0244
2022-01-29 17:31:45   Cache: 2 / 5
2022-01-29 17:38:15   Epoch[07](2/5): current batch triplet loss = 0.0118, average epoch triplet loss = 0.0248
2022-01-29 17:38:15   Cache: 3 / 5
2022-01-29 17:44:43   Epoch[07](3/5): current batch triplet loss = 0.0148, average epoch triplet loss = 0.0247
2022-01-29 17:44:43   Cache: 4 / 5
2022-01-29 17:51:15   Epoch[07](4/5): current batch triplet loss = 0.0258, average epoch triplet loss = 0.0246
2022-01-29 17:51:15   Finished epoch 07 in 0:34:22, average epoch triplet loss = 0.0246
2022-01-29 17:51:15   Extracting database features for evaluation/testing
2022-01-29 17:53:07   Extracting queries features for evaluation/testing
2022-01-29 17:54:35   Calculating recalls
2022-01-29 17:55:07   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 88.4, R@5: 96.1, R@10: 97.6, R@20: 98.4
2022-01-29 17:55:07   Improved: previous best R@5 = 96.1, current R@5 = 96.1
2022-01-29 17:55:07   Start training epoch: 08
2022-01-29 17:55:07   Cache: 0 / 5
2022-01-29 18:03:47   Epoch[08](0/5): current batch triplet loss = 0.0500, average epoch triplet loss = 0.0268
2022-01-29 18:03:47   Cache: 1 / 5
2022-01-29 18:10:16   Epoch[08](1/5): current batch triplet loss = 0.0068, average epoch triplet loss = 0.0256
2022-01-29 18:10:16   Cache: 2 / 5
2022-01-29 18:16:49   Epoch[08](2/5): current batch triplet loss = 0.0037, average epoch triplet loss = 0.0250
2022-01-29 18:16:49   Cache: 3 / 5
2022-01-29 18:23:18   Epoch[08](3/5): current batch triplet loss = 0.0394, average epoch triplet loss = 0.0254
2022-01-29 18:23:18   Cache: 4 / 5
2022-01-29 18:29:49   Epoch[08](4/5): current batch triplet loss = 0.0050, average epoch triplet loss = 0.0254
2022-01-29 18:29:49   Finished epoch 08 in 0:34:41, average epoch triplet loss = 0.0254
2022-01-29 18:29:49   Extracting database features for evaluation/testing
2022-01-29 18:31:41   Extracting queries features for evaluation/testing
2022-01-29 18:33:08   Calculating recalls
2022-01-29 18:33:40   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 88.3, R@5: 96.1, R@10: 97.6, R@20: 98.4
2022-01-29 18:33:40   Improved: previous best R@5 = 96.1, current R@5 = 96.1
2022-01-29 18:33:40   Start training epoch: 09
2022-01-29 18:33:40   Cache: 0 / 5
2022-01-29 18:42:28   Epoch[09](0/5): current batch triplet loss = 0.0277, average epoch triplet loss = 0.0262
2022-01-29 18:42:28   Cache: 1 / 5
2022-01-29 18:49:42   Epoch[09](1/5): current batch triplet loss = 0.0127, average epoch triplet loss = 0.0249
2022-01-29 18:49:42   Cache: 2 / 5
2022-01-30 15:02:12   Arguments: Namespace(aug_prob=0.5, cache_refresh_rate=1000, colab_folder='Run_4_Netvlad_SGD_001', data_aug=None, dataset_name='pitts30k', datasets_folder='/content/', device='cuda', epochs_num=50, exp_name='default', infer_batch_size=16, lr=0.001, margin=0.1, neg_samples_num=1000, negs_num_per_query=10, num_clusters=64, num_workers=8, optimizer='SGD', output_folder='drive/MyDrive/Run_4_Netvlad_SGD_001', patience=3, queries_per_epoch=5000, recall_values=[1, 5, 10, 20], seed=0, train_batch_size=4, train_positives_dist_threshold=10, type='NETVLAD', val_positive_dist_threshold=25)
2022-01-30 15:02:13   The outputs are being saved in drive/MyDrive/Run_4_Netvlad_SGD_001
2022-01-30 15:02:13   Using 1 GPUs and 2 CPUs
2022-01-30 15:02:13   Loading dataset Pitts30k from folder /content/
2022-01-30 15:02:14   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-01-30 15:02:14   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-01-30 15:02:14   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-01-30 15:02:14   Train only conv4 of the ResNet-18 (remove conv5), freeze the previous ones
2022-01-30 15:02:14   Using NetVlad network
2022-01-30 15:02:16   Using SGD optimizer
2022-01-30 15:02:16   Output dimension of the model is 16384
2022-01-30 15:02:20   Patience: 3
2022-01-30 15:02:20   not improved num: 0
2022-01-30 15:02:20   Start training epoch: 09
2022-01-30 15:02:20   Cache: 0 / 5
2022-01-30 15:14:50   Epoch[09](0/5): current batch triplet loss = 0.0148, average epoch triplet loss = 0.0138
2022-01-30 15:14:50   Cache: 1 / 5
2022-01-30 15:27:27   Epoch[09](1/5): current batch triplet loss = 0.0234, average epoch triplet loss = 0.0137
2022-01-30 15:27:27   Cache: 2 / 5
2022-01-30 15:39:58   Epoch[09](2/5): current batch triplet loss = 0.0077, average epoch triplet loss = 0.0137
2022-01-30 15:39:58   Cache: 3 / 5
2022-01-30 15:52:31   Epoch[09](3/5): current batch triplet loss = 0.0265, average epoch triplet loss = 0.0139
2022-01-30 15:52:31   Cache: 4 / 5
2022-01-30 16:05:00   Epoch[09](4/5): current batch triplet loss = 0.0280, average epoch triplet loss = 0.0142
2022-01-30 16:05:00   Finished epoch 09 in 1:02:39, average epoch triplet loss = 0.0142
2022-01-30 16:05:00   Extracting database features for evaluation/testing
2022-01-30 16:09:07   Extracting queries features for evaluation/testing
2022-01-30 16:12:14   Calculating recalls
2022-01-30 16:12:57   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 88.2, R@5: 95.9, R@10: 97.3, R@20: 98.4
2022-01-30 16:12:57   Not improved: 1 / 3: best R@5 = 96.1, current R@5 = 95.9
2022-01-30 16:12:57   Start training epoch: 10
2022-01-30 16:12:57   Cache: 0 / 5
2022-01-30 16:27:10   Epoch[10](0/5): current batch triplet loss = 0.0381, average epoch triplet loss = 0.0156
2022-01-30 16:27:10   Cache: 1 / 5
2022-01-30 16:39:36   Epoch[10](1/5): current batch triplet loss = 0.0215, average epoch triplet loss = 0.0158
2022-01-30 16:39:36   Cache: 2 / 5
2022-01-30 16:52:04   Epoch[10](2/5): current batch triplet loss = 0.0205, average epoch triplet loss = 0.0158
2022-01-30 16:52:04   Cache: 3 / 5
2022-01-30 17:04:34   Epoch[10](3/5): current batch triplet loss = 0.0274, average epoch triplet loss = 0.0160
2022-01-30 17:04:34   Cache: 4 / 5
2022-01-30 17:17:00   Epoch[10](4/5): current batch triplet loss = 0.0308, average epoch triplet loss = 0.0162
2022-01-30 17:17:00   Finished epoch 10 in 1:04:02, average epoch triplet loss = 0.0162
2022-01-30 17:17:00   Extracting database features for evaluation/testing
2022-01-30 17:20:28   Extracting queries features for evaluation/testing
2022-01-30 17:23:08   Calculating recalls
2022-01-30 17:23:50   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 88.3, R@5: 96.1, R@10: 97.6, R@20: 98.4
2022-01-30 17:23:50   Not improved: 2 / 3: best R@5 = 96.1, current R@5 = 96.1
2022-01-30 17:23:51   Start training epoch: 11
2022-01-30 17:23:51   Cache: 0 / 5
2022-01-30 17:37:28   Epoch[11](0/5): current batch triplet loss = 0.0124, average epoch triplet loss = 0.0163
2022-01-30 17:37:28   Cache: 1 / 5
2022-01-30 17:49:58   Epoch[11](1/5): current batch triplet loss = 0.0089, average epoch triplet loss = 0.0168
2022-01-30 17:49:58   Cache: 2 / 5
2022-01-30 18:02:28   Epoch[11](2/5): current batch triplet loss = 0.0055, average epoch triplet loss = 0.0168
2022-01-30 18:02:28   Cache: 3 / 5
2022-01-30 18:15:00   Epoch[11](3/5): current batch triplet loss = 0.0098, average epoch triplet loss = 0.0168
2022-01-30 18:15:00   Cache: 4 / 5
2022-01-30 18:27:26   Epoch[11](4/5): current batch triplet loss = 0.0030, average epoch triplet loss = 0.0168
2022-01-30 18:27:26   Finished epoch 11 in 1:03:35, average epoch triplet loss = 0.0168
2022-01-30 18:27:26   Extracting database features for evaluation/testing
2022-01-30 18:30:55   Extracting queries features for evaluation/testing
2022-01-30 18:33:35   Calculating recalls
2022-01-30 18:34:17   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 88.2, R@5: 96.1, R@10: 97.6, R@20: 98.4
2022-01-30 18:34:17   Improved: previous best R@5 = 96.1, current R@5 = 96.1
2022-01-30 18:34:18   Start training epoch: 12
2022-01-30 18:34:18   Cache: 0 / 5
2022-01-30 18:48:45   Epoch[12](0/5): current batch triplet loss = 0.0100, average epoch triplet loss = 0.0161
2022-01-30 18:48:45   Cache: 1 / 5
2022-01-30 19:01:16   Epoch[12](1/5): current batch triplet loss = 0.0258, average epoch triplet loss = 0.0171
2022-01-30 19:01:16   Cache: 2 / 5
2022-01-31 14:37:18   Arguments: Namespace(aug_prob=0.5, cache_refresh_rate=1000, colab_folder='Run_4_Netvlad_SGD_001', data_aug=None, dataset_name='pitts30k', datasets_folder='/content/', device='cuda', epochs_num=50, exp_name='default', infer_batch_size=16, lr=0.001, margin=0.1, neg_samples_num=1000, negs_num_per_query=10, num_clusters=64, num_workers=8, optimizer='SGD', output_folder='drive/MyDrive/Run_4_Netvlad_SGD_001', patience=3, queries_per_epoch=5000, recall_values=[1, 5, 10, 20], seed=0, train_batch_size=4, train_positives_dist_threshold=10, type='NETVLAD', val_positive_dist_threshold=25)
2022-01-31 14:37:19   The outputs are being saved in drive/MyDrive/Run_4_Netvlad_SGD_001
2022-01-31 14:37:19   Using 1 GPUs and 2 CPUs
2022-01-31 14:37:19   Loading dataset Pitts30k from folder /content/
2022-01-31 14:37:19   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-01-31 14:37:19   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-01-31 14:37:19   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-01-31 14:37:20   Train only conv4 of the ResNet-18 (remove conv5), freeze the previous ones
2022-01-31 14:37:20   Using NetVlad network
2022-01-31 14:37:21   Using SGD optimizer
2022-01-31 14:37:21   Output dimension of the model is 16384
2022-01-31 14:37:25   Patience: 3
2022-01-31 14:37:25   not improved num: 0
2022-01-31 14:37:25   Start training epoch: 12
2022-01-31 14:37:25   Cache: 0 / 5
2022-01-31 14:49:27   Epoch[12](0/5): current batch triplet loss = 0.0045, average epoch triplet loss = 0.0112
2022-01-31 14:49:27   Cache: 1 / 5
2022-01-31 15:01:31   Epoch[12](1/5): current batch triplet loss = 0.0252, average epoch triplet loss = 0.0113
2022-01-31 15:01:31   Cache: 2 / 5
2022-01-31 15:13:38   Epoch[12](2/5): current batch triplet loss = 0.0045, average epoch triplet loss = 0.0114
2022-01-31 15:13:38   Cache: 3 / 5
2022-01-31 15:25:41   Epoch[12](3/5): current batch triplet loss = 0.0242, average epoch triplet loss = 0.0117
2022-01-31 15:25:41   Cache: 4 / 5
2022-01-31 15:37:47   Epoch[12](4/5): current batch triplet loss = 0.0206, average epoch triplet loss = 0.0120
2022-01-31 15:37:47   Finished epoch 12 in 1:00:22, average epoch triplet loss = 0.0120
2022-01-31 15:37:47   Extracting database features for evaluation/testing
2022-01-31 15:41:07   Extracting queries features for evaluation/testing
2022-01-31 15:43:41   Calculating recalls
2022-01-31 15:44:23   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 88.1, R@5: 95.9, R@10: 97.5, R@20: 98.4
2022-01-31 15:44:23   Not improved: 1 / 3: best R@5 = 96.1, current R@5 = 95.9
2022-01-31 15:44:24   Start training epoch: 13
2022-01-31 15:44:24   Cache: 0 / 5
2022-01-31 15:58:21   Epoch[13](0/5): current batch triplet loss = 0.0319, average epoch triplet loss = 0.0134
2022-01-31 15:58:21   Cache: 1 / 5
2022-01-31 16:10:38   Epoch[13](1/5): current batch triplet loss = 0.0195, average epoch triplet loss = 0.0136
2022-01-31 16:10:38   Cache: 2 / 5
2022-01-31 16:22:49   Epoch[13](2/5): current batch triplet loss = 0.0137, average epoch triplet loss = 0.0135
2022-01-31 16:22:49   Cache: 3 / 5
2022-01-31 16:35:04   Epoch[13](3/5): current batch triplet loss = 0.0254, average epoch triplet loss = 0.0138
2022-01-31 16:35:04   Cache: 4 / 5
2022-01-31 16:47:12   Epoch[13](4/5): current batch triplet loss = 0.0267, average epoch triplet loss = 0.0140
2022-01-31 16:47:12   Finished epoch 13 in 1:02:48, average epoch triplet loss = 0.0140
2022-01-31 16:47:12   Extracting database features for evaluation/testing
2022-01-31 16:50:33   Extracting queries features for evaluation/testing
2022-01-31 16:53:07   Calculating recalls
2022-01-31 16:53:50   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 88.2, R@5: 96.1, R@10: 97.6, R@20: 98.4
2022-01-31 16:53:50   Not improved: 2 / 3: best R@5 = 96.1, current R@5 = 96.1
2022-01-31 16:53:50   Start training epoch: 14
2022-01-31 16:53:50   Cache: 0 / 5
2022-01-31 17:07:32   Epoch[14](0/5): current batch triplet loss = 0.0089, average epoch triplet loss = 0.0140
2022-01-31 17:07:32   Cache: 1 / 5
2022-01-31 17:19:41   Epoch[14](1/5): current batch triplet loss = 0.0086, average epoch triplet loss = 0.0145
2022-01-31 17:19:41   Cache: 2 / 5
2022-01-31 17:31:51   Epoch[14](2/5): current batch triplet loss = 0.0039, average epoch triplet loss = 0.0146
2022-01-31 17:31:51   Cache: 3 / 5
2022-01-31 17:44:01   Epoch[14](3/5): current batch triplet loss = 0.0085, average epoch triplet loss = 0.0146
2022-01-31 17:44:01   Cache: 4 / 5
2022-01-31 17:56:10   Epoch[14](4/5): current batch triplet loss = 0.0029, average epoch triplet loss = 0.0147
2022-01-31 17:56:10   Finished epoch 14 in 1:02:19, average epoch triplet loss = 0.0147
2022-01-31 17:56:10   Extracting database features for evaluation/testing
2022-01-31 17:59:30   Extracting queries features for evaluation/testing
2022-01-31 18:02:04   Calculating recalls
2022-01-31 18:02:45   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 88.2, R@5: 96.1, R@10: 97.6, R@20: 98.5
2022-01-31 18:02:45   Not improved: 3 / 3: best R@5 = 96.1, current R@5 = 96.1
2022-01-31 18:02:46   Performance did not improve for 3 epochs. Stop training.
2022-01-31 18:02:46   Best R@5: 96.1
2022-01-31 18:02:46   Trained for 15 epochs, in total in 3:25:28
2022-01-31 18:14:00   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2022-01-31 18:14:00   Extracting database features for evaluation/testing
2022-01-31 18:17:25   Extracting queries features for evaluation/testing
2022-01-31 18:19:45   Calculating recalls
2022-01-31 18:20:23   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 86.7, R@5: 93.1, R@10: 95.2, R@20: 96.6
2022-01-31 18:20:23   Test set: < BaseDataset, st_lucia - #database: 1549; #queries: 1464 >
2022-01-31 18:20:23   Extracting database features for evaluation/testing
2022-01-31 18:21:09   Extracting queries features for evaluation/testing
2022-01-31 18:21:57   Calculating recalls
2022-01-31 18:21:59   Recalls on < BaseDataset, st_lucia - #database: 1549; #queries: 1464 >: R@1: 57.0, R@5: 71.4, R@10: 77.1, R@20: 83.3
